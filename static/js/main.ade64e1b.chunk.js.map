{"version":3,"sources":["components/PortWidget.tsx","state/generateElementId.ts","state/types.ts","state/store.ts","state/nodes.ts","components/PropertyWidget.tsx","components/PropertiesWidget.tsx","property_services/AnglePropertyService.tsx","property_services/ArrayStringPropertyService/index.ts","property_services/ArrayXYPropertyService.tsx","property_services/BlendModePropertyService.tsx","property_services/CustomPropertyService.tsx","property_services/MatrixPropertyService/index.ts","property_services/NumberPropertyService/index.ts","property_services/RefPropertyService.tsx","property_services/TextPropertyService.tsx","property_services/ArrayStringPropertyService/ArrayStringPropertyControl.tsx","property_services/ArrayStringPropertyService/ArrayStringPropertyService.tsx","property_services/MatrixPropertyService/MatrixPropertyControl.tsx","property_services/MatrixPropertyService/MatrixPropertyService.tsx","property_services/NumberPropertyService/NumberPropertyService.tsx","property_services/NumberPropertyService/NumberPropertyControl.tsx","services_registry.ts","node_services/AreaBumpNodeService.tsx","node_services/AxisNodeService.ts","node_services/BlendModeNodeService.ts","node_services/CanvasNodeService.tsx","node_services/ChordNodeService.tsx","node_services/ColorSchemeNodeService.ts","node_services/LineNodeService.tsx","node_services/MarginNodeService.tsx","node_services/ScatterPlotNodeService.tsx","node_services/SeriesXYNodeService.tsx","node_services/SerieXYNodeService.ts","registry.ts","node_services/MatrixNodeService.tsx","node_services/NivoThemeNodeService.tsx","components/ui/Input.tsx","theming/GlobalStyle.tsx","theming/themes/index.ts","theming/themes/darkTheme.ts","theming/themes/lightTheme.ts","components/AppFooter.tsx","components/AppHeader.tsx","components/LinkingLayer.tsx","components/LinkWidget.tsx","components/LinksLayer.tsx","components/NodeInfoPanel/NodeName.tsx","utils/useDocumentEventListener.ts","components/NodeInfoPanel/PropertyItem.tsx","components/NodeInfoPanel/NodeInfoPanel.tsx","components/NodeWidget.tsx","components/NodesLayer.tsx","components/Modal.tsx","components/SidebarButton.tsx","components/NodeSelector.tsx","components/AddNodeButton.tsx","components/NewGraph.tsx","fs.ts","components/SaveGraph.tsx","components/OpenGraph.tsx","components/Settings.tsx","components/Sidebar.tsx","examples/index.ts","components/ExampleLoader.tsx","components/Welcome.tsx","App.tsx","theming/hooks.ts","reportWebVitals.js","index.tsx","property_services/index.ts","property_services/ChoicesPropertyService.tsx"],"names":["PortWidget","memo","type","elementId","x","y","useLinkingActions","startLinking","setLinkingPotentialPort","resetLinkingPotentialPort","handleLinking","useCallback","event","stopPropagation","anchor","initial","clientX","clientY","handleMouseEnter","handleMouseLeave","Container","onMouseDown","onMouseEnter","onMouseLeave","style","left","Port","styled","div","PORT_SIZE","props","theme","colors","background","accentColor","CONTAINER_SIZE","generateElementId","uuidV4","isProperty","element","elementType","isNode","isLink","updateNodePosition","elements","nodeId","offset","node","find","id","map","properties","includes","useStore","create","set","settings","themeId","setSettings","partialSettings","state","selectedNodeIds","setSelectedNodeIds","createNode","nodeService","registry","getNodeService","newNode","name","replace","width","height","data","factory","newProperties","forEach","property","propertyService","getPropertyService","newProperty","length","hasInput","hasOutput","push","hydrate","removeNode","filter","updateNode","patch","updateProperty","propertyId","loadGraph","graph","nodes","propertyIds","links","link","sourceId","targetId","drag","isDragging","startDrag","updateDrag","position","stopDrag","linking","isLinking","undefined","previous","updateLinking","potentialId","stopLinking","unlink","settingsSelector","useSettings","loadGraphSelector","useLoadGraph","createNodeSelector","useCreateNode","updateNodeSelector","useUpdateNode","unlinkSelector","useUnlink","setSelectedNodeIdsSelector","useSetSelectedNodeIds","shallow","serializeProperties","serialize","serializeElements","source","target","useGraph","useMemo","resolvedNodes","propertiesByNodeId","resolvedProperties","resolvedLinks","isSelected","propertyNode","Error","dependencies","Object","values","input","resolveGraph","useSelectedNodes","PropertyWidget","PropertyContainer","PropertyName","transparentize","topDepthBackground","span","PropertiesWidget","propertyServices","createElement","widget","AnglePropertyService","defaultValue","value","getValue","control","onChange","console","log","ControlContainer","ControlAddItemButton","ArrayXYPropertyService","handleChange","itemIndex","key","item","index","Number","size","onClick","blendModeChoices","label","BlendModePropertyService","ChoicesPropertyService","choices","ChoicesPropertyControl","CustomPropertyService","renderer","RefPropertyService","resolvePropertyValue","TextPropertyService","Grid","RemoveButton","AddItemButton","ArrayStringPropertyService","setValue","_","i","handleRemove","SizeContainer","MatrixWrapper","MatrixContainer","columns","rows","MatrixPropertyService","xSize","ySize","Array","isArray","valueUpdate","handleSizeChange","newXSize","newYSize","newValue","slice","newRowIndex","from","fill","row","newRow","newColumnIndex","rowIndex","cell","columnIndex","targetRowIndex","targetColumnIndex","handleValueChange","NumberPropertyService","options","partialOptions","controlType","min","max","step","ServiceRegistry","nodeServices","this","nodeType","grouped","entries","groupBy","sortBy","group","category","types","propertyType","ownValue","AreaBumpNodeService","description","spacing","xPadding","isInteractive","AxisNodeService","tickSize","tickPadding","tickRotation","legend","legendOffset","propertyValues","keyBy","nodeValue","BlendModeNodeService","blendMode","CanvasNodeService","content","backgroundColor","overflow","ChordNodeService","keys","innerRadiusRatio","innerRadiusOffset","matrix","ColorSchemeNodeService","scheme","LineNodeService","MarginNodeService","top","right","bottom","ScatterPlotNodeService","SeriesXYNodeService","SerieXYNodeService","servicesRegistry","registerNodeService","fontFamily","fontSize","textColor","grid","line","stroke","tooltip","container","color","borderRadius","boxShadow","padding","registerPropertyService","Input","inputBackground","inputText","GlobalStyle","createGlobalStyle","text","themes","mediumDepthBackground","badgeBackground","border","lightBorder","nodeBorder","success","overlay","AppFooter","footer","AppHeader","Header","header","ICON_SIZE","LinkingLayer","iconPosition","icon","pointerEvents","Line","strokeLinecap","x1","x2","y1","y2","Circle","cx","cy","r","Icon","isValid","circle","lineGenerator","d3Line","curve","curveBasis","UNLINK_BUTTON_SIZE","LinkWidget","sourceElementType","sourceX","sourceY","sourceWidth","sourceHeight","targetX","targetY","targetHeight","sourcePosition","targetPosition","xDistance","center","xOffset","Math","abs","points","path","useState","isHover","setIsHover","handleHover","handleOut","handleUnlink","Path","d","CapturePath","UnlinkButton","LinksLayer","NodeName","currentName","isEditing","setIsEditing","setName","inputRef","useRef","useEffect","current","focus","eventType","listener","handleEscape","document","addEventListener","removeEventListener","Name","ref","onKeyPress","Relation","ownId","parentName","goToRelation","RelationContainer","RelationName","UnlinkIcon","PropertyItem","PropertyHeader","h4","NodeInfoPanel","handleClose","Id","Close","Properties","NodeValueTitle","$$typeof","NodeValue","JSON","stringify","pre","NodeWidget","hasCustomWidget","handleStartDrag","NodeContainer","NodeHeader","NodesLayer","Layer","Modal","children","maxWidth","onCloseRequest","createPortal","role","aria-modal","onKeyDown","Background","Content","body","ModalTitle","h2","Button","SidebarButton","NodeType","onCreate","NodeTypeItem","NodeTypeDescription","Category","CategoryTitle","NodeSelector","categories","getNodeServiceCategories","h3","AddNodeButton","isOpen","setIsOpen","NewGraph","handleNewGraph","ConfirmContainer","saveAsJSON","a","serialized","stringified","version","blob","Blob","fileSave","fileName","extensions","fileHandle","parseFileContent","Promise","resolve","reader","FileReader","readAsText","onloadend","readyState","DONE","result","parse","loadFromJSON","fileOpen","mimeTypes","SaveGraph","OpenGraph","handleOpen","then","Settings","Sidebar","examples","ExampleItem","example","onLoad","handleLoad","ExampleItemContainer","ExampleLoader","Welcome","Message","display","justifyContent","margin","cursor","App","store","useCurrentTheme","selectedNodes","handleMouseMove","handleMouseOut","Canvas","onMouseMove","onMouseUp","InfoPanel","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","choice"],"mappings":"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","file":"static/js/main.ade64e1b.chunk.js","sourcesContent":["import { useCallback, MouseEvent, memo } from 'react'\nimport styled from 'styled-components'\nimport { ElementId, useLinkingActions } from '../state'\n\nconst CONTAINER_SIZE = 20\nconst PORT_SIZE = 10\n\nexport const PortWidget = memo(\n    ({\n        type,\n        elementId,\n        x,\n        y,\n    }: {\n        type: 'source' | 'target'\n        elementId: ElementId\n        x: number\n        y: number\n    }) => {\n        const {\n            startLinking,\n            setLinkingPotentialPort,\n            resetLinkingPotentialPort,\n        } = useLinkingActions()\n\n        const handleLinking = useCallback(\n            (event: MouseEvent) => {\n                event.stopPropagation()\n\n                startLinking({\n                    elementId,\n                    type,\n                    anchor: [x, y],\n                    initial: [event.clientX, event.clientY],\n                })\n            },\n            [startLinking, elementId, type, x, y]\n        )\n\n        const handleMouseEnter = useCallback(() => {\n            setLinkingPotentialPort(elementId, type)\n        }, [setLinkingPotentialPort, elementId, type])\n\n        const handleMouseLeave = useCallback(() => {\n            resetLinkingPotentialPort()\n        }, [resetLinkingPotentialPort])\n\n        return (\n            <Container\n                onMouseDown={handleLinking}\n                onMouseEnter={handleMouseEnter}\n                onMouseLeave={handleMouseLeave}\n                style={{\n                    left: type === 'target' ? 0 : '100%',\n                }}\n            >\n                <Port />\n            </Container>\n        )\n    }\n)\n\nconst Port = styled.div`\n    pointer-events: all;\n    width: ${PORT_SIZE}px;\n    height: ${PORT_SIZE}px;\n    border-radius: ${PORT_SIZE / 2}px;\n    background: ${props => props.theme.colors.background};\n    border: 2px solid ${props => props.theme.colors.accentColor};\n    transition: transform 200ms;\n`\n\nconst Container = styled.div`\n    pointer-events: all;\n    position: absolute;\n    top: 50%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: ${CONTAINER_SIZE}px;\n    height: ${CONTAINER_SIZE}px;\n    margin-top: -${CONTAINER_SIZE / 2}px;\n    margin-left: -${CONTAINER_SIZE / 2}px;\n    cursor: pointer;\n\n    &:hover {\n        ${Port} {\n            transform: scale(1.6);\n        }\n    }\n`\n","import { v4 as uuidV4 } from 'uuid'\nimport { ElementId } from './types'\n\nexport const generateElementId = (): ElementId => uuidV4()\n","export type ElementId = string\n\nexport interface CreateProperty {\n    type: string\n    name: string\n    hasInput?: boolean\n    hasOutput?: boolean\n}\n\nexport interface Property extends CreateProperty {\n    name: string\n    hasInput: boolean\n    hasOutput: boolean\n    id: ElementId\n    elementType: 'property'\n    nodeId: ElementId\n    x: number\n    y: number\n    width: number\n    height: number\n}\n\nexport interface ResolvedProperty extends Property {\n    node: ResolvedNode\n    dependencies: (ResolvedNode | ResolvedProperty)[]\n    input?: ResolvedNode | ResolvedProperty\n}\n\nexport const isProperty = (element: Element): element is Property =>\n    element.elementType === 'property'\n\nexport interface Node<Data = any> {\n    elementType: 'node'\n    type: string\n    id: ElementId\n    x: number\n    y: number\n    width: number\n    name: string\n    data: Data\n    height: number\n    properties: ElementId[]\n}\n\nexport interface ResolvedNode extends Omit<Node, 'properties'> {\n    isSelected: boolean\n    properties: ResolvedProperty[]\n}\n\nexport interface SerializedNode {\n    id: ElementId\n    type: string\n    name: string\n    x: number\n    y: number\n    width: number\n}\n\nexport interface SerializedElements {\n    nodes: SerializedNode[]\n    links: any[]\n}\n\nexport const isNode = (element: Element): element is Node => element.elementType === 'node'\n\nexport interface Link {\n    id: ElementId\n    elementType: 'link'\n    sourceId: ElementId\n    targetId: ElementId\n}\n\nexport const isLink = (element: Element): element is Link => element.elementType === 'link'\n\nexport interface ResolvedLink extends Link {\n    source: ResolvedNode | ResolvedProperty\n    target: ResolvedNode | ResolvedProperty\n}\n\nexport type Element = Node | Property | Link\n\nexport interface AppSettings {\n    themeId: string\n}\n\nexport type State = {\n    settings: AppSettings\n    setSettings: (partialSettings: Partial<AppSettings>) => void\n    // flat representation of all nodes/properties/links\n    elements: Element[]\n    selectedNodeIds: ElementId[]\n    setSelectedNodeIds: (ids: ElementId[]) => void\n    createNode: (type: string) => void\n    updateNode: (id: ElementId, patch: any) => void\n    removeNode: (id: ElementId) => void\n    updateProperty: (propertyId: ElementId, patch: any) => void\n    loadGraph: (graph: any) => void\n    //\n    // DRAGGING\n    //\n    drag: {\n        isDragging: boolean\n        elementId: ElementId | null\n        initial: [number, number]\n        offset: [number, number]\n    }\n    startDrag: (elementId: ElementId, initial: [number, number]) => void\n    updateDrag: (position: [number, number]) => void\n    stopDrag: () => void\n    //\n    // LINKING\n    //\n    linking: {\n        isLinking: boolean\n        elementId?: ElementId\n        potentialId?: ElementId\n        type: 'source' | 'target'\n        anchor: [number, number]\n        position: [number, number]\n        previous: [number, number]\n    }\n    startLinking: (props: {\n        elementId?: ElementId\n        type: 'source' | 'target'\n        anchor: [number, number]\n        initial: [number, number]\n    }) => void\n    updateLinking: (position: [number, number]) => void\n    setLinkingPotentialPort: (elementId: ElementId, type: 'source' | 'target') => void\n    resetLinkingPotentialPort: () => void\n    stopLinking: () => void\n    link: (sourceId: ElementId, targetId: ElementId) => void\n    unlink: (sourceId: ElementId, targetId: ElementId) => void\n}\n","import { useMemo } from 'react'\nimport create from 'zustand'\nimport shallow from 'zustand/shallow'\nimport {\n    Element,\n    ElementId,\n    State,\n    Node,\n    ResolvedNode,\n    isNode,\n    Property,\n    ResolvedProperty,\n    isProperty,\n    Link,\n    ResolvedLink,\n    isLink,\n    SerializedElements,\n} from './types'\nimport { generateElementId } from './generateElementId'\nimport registry from '../registry'\n\nconst DEFAULT_NODE_HEADER_HEIGHT = 24\nconst PROPERTY_HEIGHT = 20\n\nconst updateNodePosition = (\n    elements: Element[],\n    nodeId: ElementId | null,\n    offset: [number, number]\n): Element[] => {\n    if (nodeId === null) {\n        return elements\n    }\n\n    const node: Node | undefined = elements.find(\n        element => isNode(element) && element.id === nodeId\n    ) as any\n    if (!node) {\n        return elements\n    }\n\n    return elements.map(element => {\n        if (\n            (isNode(element) && element.id === node.id) ||\n            (isProperty(element) && node.properties.includes(element.id))\n        ) {\n            return {\n                ...element,\n                x: element.x + offset[0],\n                y: element.y + offset[1],\n            }\n        }\n\n        return element\n    })\n}\n\nexport const useStore = create<State>(set => ({\n    settings: {\n        themeId: 'light',\n    },\n    setSettings: partialSettings =>\n        set(state => {\n            return {\n                settings: {\n                    ...state.settings,\n                    ...partialSettings,\n                },\n            }\n        }),\n    elements: [],\n    selectedNodeIds: [],\n    setSelectedNodeIds: selectedNodeIds => set(() => ({ selectedNodeIds })),\n    createNode: type =>\n        set(state => {\n            const nodeService = registry.getNodeService(type)\n\n            const newNode: Node = {\n                elementType: 'node',\n                id: generateElementId(),\n                type: type,\n                name: nodeService.type.replace('_', ' '),\n                x: 100,\n                y: 100,\n                width: 120,\n                height: 100,\n                properties: [],\n                data: nodeService.factory(),\n            }\n\n            const newProperties: Property[] = []\n            nodeService.properties.forEach(property => {\n                const propertyService = registry.getPropertyService(property.type)\n\n                const newProperty: Property = {\n                    ...property,\n                    elementType: 'property',\n                    id: generateElementId(),\n                    nodeId: newNode.id,\n                    name: property.name,\n                    x: newNode.x,\n                    y:\n                        newNode.y +\n                        DEFAULT_NODE_HEADER_HEIGHT +\n                        newProperties.length * PROPERTY_HEIGHT,\n                    height: PROPERTY_HEIGHT,\n                    width: newNode.width,\n                    hasInput: property.hasInput || false,\n                    hasOutput: property.hasOutput || false,\n                }\n\n                newProperties.push(\n                    propertyService.hydrate(newProperty, newNode.data[property.name])\n                )\n            })\n\n            newNode.properties = newProperties.map(property => property.id)\n\n            return {\n                elements: [...state.elements, ...newProperties, newNode],\n                selectedNodeIds: [newNode.id],\n            }\n        }),\n    removeNode: id =>\n        set(state => {\n            return {\n                elements: state.elements.filter(element => element.id !== id),\n            }\n        }),\n    updateNode: (id, patch) =>\n        set(state => {\n            const updatedElements = state.elements.map(element => {\n                if (!isNode(element) || element.id !== id) {\n                    return element\n                }\n\n                return {\n                    ...element,\n                    ...patch,\n                }\n            })\n\n            return {\n                elements: updatedElements,\n            }\n        }),\n    updateProperty: (propertyId, patch) =>\n        set(state => {\n            const updatedElements = state.elements.map(element => {\n                if (!isProperty(element) || element.id !== propertyId) {\n                    return element\n                }\n\n                return {\n                    ...element,\n                    ...patch,\n                }\n            })\n\n            return {\n                elements: updatedElements,\n            }\n        }),\n    loadGraph: graph =>\n        set(state => {\n            const elements: any[] = []\n\n            graph.nodes.forEach((node: any) => {\n                const nodeService = registry.getNodeService(node.type)\n                const propertyIds: ElementId[] = []\n\n                nodeService.properties.forEach(property => {\n                    const propertyService = registry.getPropertyService(property.type)\n\n                    const propertyId = node.data[property.name]\n                        ? node.data[property.name].id\n                        : generateElementId()\n\n                    let newProperty = {\n                        ...propertyService.factory(property),\n                        ...property,\n                        elementType: 'property',\n                        id: propertyId,\n                        nodeId: node.id,\n                        name: property.name,\n                        x: node.x,\n                        y:\n                            DEFAULT_NODE_HEADER_HEIGHT +\n                            node.y +\n                            propertyIds.length * PROPERTY_HEIGHT,\n                        width: node.width,\n                        height: PROPERTY_HEIGHT,\n                    } as Property\n\n                    if (node.data[property.name]) {\n                        newProperty = propertyService.hydrate(\n                            newProperty,\n                            node.data[property.name].data\n                        )\n                    }\n\n                    elements.push(newProperty)\n                    propertyIds.push(newProperty.id)\n                })\n\n                elements.push({\n                    elementType: 'node',\n                    id: node.id,\n                    type: node.type,\n                    name: node.name || node.type.replace('_', ' '),\n                    x: node.x,\n                    y: node.y,\n                    width: node.width,\n                    height: DEFAULT_NODE_HEADER_HEIGHT + propertyIds.length * PROPERTY_HEIGHT,\n                    properties: propertyIds,\n                })\n            })\n\n            graph.links.forEach((link: any) => {\n                elements.push({\n                    elementType: 'link',\n                    id: link.id,\n                    sourceId: link.sourceId,\n                    targetId: link.targetId,\n                })\n            })\n\n            return {\n                selectedNodeIds: [],\n                elements,\n                drag: {\n                    isDragging: false,\n                    elementId: null,\n                    initial: [0, 0],\n                    offset: [0, 0],\n                },\n            }\n        }),\n    //\n    // dragging\n    //\n    drag: {\n        isDragging: false,\n        elementId: null,\n        initial: [0, 0],\n        offset: [0, 0],\n    },\n    startDrag: (elementId, initial) =>\n        set(state => {\n            return {\n                drag: {\n                    isDragging: true,\n                    elementId: elementId,\n                    initial,\n                    offset: [0, 0],\n                },\n            }\n        }),\n    updateDrag: position =>\n        set(state => {\n            const offset: [number, number] = [\n                position[0] - state.drag.initial[0],\n                position[1] - state.drag.initial[1],\n            ]\n\n            return {\n                drag: {\n                    ...state.drag,\n                    offset,\n                    initial: [position[0], position[1]],\n                },\n                elements: updateNodePosition(state.elements, state.drag.elementId, offset),\n            }\n        }),\n    stopDrag: () =>\n        set(state => {\n            return {\n                drag: {\n                    isDragging: false,\n                    elementId: null,\n                    initial: [0, 0],\n                    offset: [0, 0],\n                },\n            }\n        }),\n    linking: {\n        isLinking: false,\n        elementId: undefined,\n        type: 'source',\n        anchor: [0, 0],\n        position: [0, 0],\n        previous: [0, 0],\n    },\n    startLinking: ({ elementId, type, anchor, initial }) =>\n        set(() => {\n            return {\n                linking: {\n                    isLinking: true,\n                    elementId,\n                    type,\n                    anchor,\n                    position: anchor,\n                    previous: initial,\n                },\n            }\n        }),\n    updateLinking: position =>\n        set(state => {\n            const offset = [\n                position[0] - state.linking.previous[0],\n                position[1] - state.linking.previous[1],\n            ]\n\n            return {\n                linking: {\n                    ...state.linking,\n                    position: [\n                        state.linking.position[0] + offset[0],\n                        state.linking.position[1] + offset[1],\n                    ],\n                    previous: position,\n                },\n            }\n        }),\n    setLinkingPotentialPort: (elementId, type) =>\n        set(state => {\n            if (\n                // no current linking\n                !state.linking.isLinking ||\n                // source & target are identical\n                elementId === state.linking.elementId ||\n                // both are sources or targets\n                state.linking.type === type\n            ) {\n                return state\n            }\n\n            return {\n                linking: {\n                    ...state.linking,\n                    potentialId: elementId,\n                },\n            }\n        }),\n    resetLinkingPotentialPort: () =>\n        set(state => {\n            return {\n                linking: {\n                    ...state.linking,\n                    potentialId: undefined,\n                },\n            }\n        }),\n    stopLinking: () =>\n        set(state => {\n            let elements = state.elements\n            if (state.linking.elementId !== undefined && state.linking.potentialId !== undefined) {\n                const link: Link = {\n                    id: generateElementId(),\n                    elementType: 'link',\n                    sourceId:\n                        state.linking.type === 'source'\n                            ? state.linking.elementId\n                            : state.linking.potentialId,\n                    targetId:\n                        state.linking.type === 'source'\n                            ? state.linking.potentialId\n                            : state.linking.elementId,\n                }\n\n                elements = [...elements, link]\n            }\n\n            return {\n                elements,\n                linking: {\n                    isLinking: false,\n                    type: 'source',\n                    anchor: [0, 0],\n                    position: [0, 0],\n                    previous: [0, 0],\n                },\n            }\n        }),\n    link: (sourceId: ElementId, targetId: ElementId) =>\n        set(state => {\n            const link: Link = {\n                id: generateElementId(),\n                elementType: 'link',\n                sourceId,\n                targetId,\n            }\n\n            return {\n                elements: [...state.elements, link],\n            }\n        }),\n    unlink: (sourceId: ElementId, targetId: ElementId) =>\n        set(state => {\n            return {\n                elements: state.elements.filter(element => {\n                    return (\n                        !isLink(element) ||\n                        element.sourceId !== sourceId ||\n                        element.targetId !== targetId\n                    )\n                }),\n            }\n        }),\n}))\n\nconst settingsSelector = (state: State) => state.settings\nexport const useSettings = () => useStore(settingsSelector)\n\nconst loadGraphSelector = (state: State) => state.loadGraph\nexport const useLoadGraph = () => useStore(loadGraphSelector)\n\nconst createNodeSelector = (state: State) => state.createNode\nexport const useCreateNode = () => useStore(createNodeSelector)\n\nconst updateNodeSelector = (state: State) => state.updateNode\nexport const useUpdateNode = () => useStore(updateNodeSelector)\n\nconst unlinkSelector = (state: State) => state.unlink\nexport const useUnlink = () => useStore(unlinkSelector)\n\nconst setSelectedNodeIdsSelector = (state: State) => state.setSelectedNodeIds\nexport const useSetSelectedNodeIds = () => useStore(setSelectedNodeIdsSelector)\n\nexport const useLinkingActions = () =>\n    useStore(\n        state => ({\n            startLinking: state.startLinking,\n            updateLinking: state.updateLinking,\n            setLinkingPotentialPort: state.setLinkingPotentialPort,\n            resetLinkingPotentialPort: state.resetLinkingPotentialPort,\n        }),\n        shallow\n    )\n\nconst serializeProperties = (properties: ResolvedProperty[]) => {\n    const props: any = {}\n    properties.forEach(property => {\n        props[property.name] = {\n            id: property.id,\n            data: registry.getPropertyService(property.type).serialize(property),\n        }\n    })\n\n    return props\n}\n\nexport const serializeElements = (\n    nodes: ResolvedNode[],\n    links: ResolvedLink[]\n): SerializedElements => {\n    return {\n        nodes: nodes.map(node => {\n            return {\n                id: node.id,\n                type: node.type,\n                name: node.name,\n                x: node.x,\n                y: node.y,\n                width: node.width,\n                data: serializeProperties(node.properties),\n            }\n        }),\n        links: links.map(link => {\n            return {\n                id: link.id,\n                sourceId: link.source.id,\n                targetId: link.target.id,\n            }\n        }),\n    }\n}\n\nconst resolveGraph = (elements: Element[]) => {\n    const resolvedNodes: Record<ElementId, ResolvedNode> = {}\n    const propertiesByNodeId: Record<ElementId, ElementId[]> = {}\n    const resolvedProperties: Record<ElementId, ResolvedProperty> = {}\n    const resolvedLinks: Record<ElementId, ResolvedLink> = {}\n\n    const nodes = elements.filter(isNode)\n    const properties = elements.filter(isProperty)\n    const links = elements.filter(isLink)\n\n    // first pass to resolve nodes without resolving\n    // their properties.\n    nodes.forEach(node => {\n        propertiesByNodeId[node.id] = node.properties\n\n        resolvedNodes[node.id] = {\n            ...node,\n            isSelected: false,\n            properties: [],\n        }\n    })\n\n    // first pass to resolve properties without resolving\n    // dependencies.\n    properties.forEach(property => {\n        const propertyNode = resolvedNodes[property.nodeId]\n        if (!propertyNode) {\n            throw new Error(`unable to find property node: ${property.nodeId}`)\n        }\n\n        resolvedProperties[property.id] = {\n            ...property,\n            node: propertyNode,\n            dependencies: [],\n        }\n    })\n\n    // assign resolved properties to nodes.\n    Object.values(resolvedNodes).forEach(node => {\n        if (node.id in propertiesByNodeId) {\n            propertiesByNodeId[node.id].forEach(propertyId => {\n                const property = resolvedProperties[propertyId]\n                if (!property) {\n                    throw new Error(`unable to find property: ${propertyId}`)\n                }\n\n                node.properties.push(property)\n            })\n        }\n    })\n\n    links.forEach(link => {\n        const source: ResolvedNode | ResolvedProperty =\n            resolvedNodes[link.sourceId] || resolvedProperties[link.sourceId]\n        if (!source) {\n            throw new Error(`unable to find link source: ${link.sourceId}`)\n        }\n\n        const target: ResolvedNode | ResolvedProperty =\n            resolvedNodes[link.targetId] || resolvedProperties[link.targetId]\n        if (!target) {\n            throw new Error(`unable to find link target: ${link.sourceId}`)\n        }\n\n        // @ts-ignore\n        if (target.elementType === 'property') {\n            // @ts-ignore\n            target.input = source\n        }\n\n        resolvedLinks[link.id] = {\n            ...link,\n            source,\n            target,\n        }\n    })\n\n    return {\n        nodes: Object.values(resolvedNodes),\n        properties: Object.values(resolvedProperties),\n        links: Object.values(resolvedLinks),\n    }\n}\n\nexport const useGraph = () => {\n    const { elements, selectedNodeIds } = useStore()\n\n    const graph = useMemo(() => resolveGraph(elements), [elements])\n\n    useMemo(() => {\n        graph.nodes.forEach(node => {\n            node.isSelected = selectedNodeIds.includes(node.id)\n        })\n    }, [graph, selectedNodeIds])\n\n    return graph\n}\n","import { State, isNode } from './types'\nimport { useGraph, useStore } from './store'\n\nconst nodesSelector = (state: State) => state.elements.filter(isNode)\n\nexport const useNodes = () => useStore(nodesSelector)\n\nexport const useSelectedNodes = () => {\n    const state = useStore()\n    const { nodes } = useGraph()\n\n    if (state.selectedNodeIds.length === 0) {\n        return []\n    }\n\n    return nodes.filter(node => state.selectedNodeIds.includes(node.id))\n}\n","import { memo } from 'react'\nimport styled from 'styled-components'\nimport { transparentize } from 'polished'\nimport { Property } from '../state'\nimport { PortWidget } from './PortWidget'\n\nexport const PropertyWidget = memo(({ property }: { property: Property }) => {\n    return (\n        <PropertyContainer>\n            <PropertyName>{property.name}</PropertyName>\n            {property.hasInput && (\n                <PortWidget\n                    type=\"target\"\n                    elementId={property.id}\n                    x={property.x}\n                    y={property.y + property.height / 2}\n                />\n            )}\n            {property.hasOutput && (\n                <PortWidget\n                    type=\"source\"\n                    elementId={property.id}\n                    x={property.x + property.width}\n                    y={property.y + property.height / 2}\n                />\n            )}\n        </PropertyContainer>\n    )\n})\n\nconst PropertyContainer = styled.div`\n    position: relative;\n    height: 20px;\n    user-select: none;\n    display: flex;\n    align-items: center;\n    padding: 0 12px;\n    background-color: ${props => transparentize(0.6, props.theme.colors.topDepthBackground)};\n    color: ${props => props.theme.colors.accentColor};\n    font-size: 11px;\n`\n\nconst PropertyName = styled.span`\n    overflow: hidden;\n    text-overflow: ellipsis;\n`\n","import { createElement, memo } from 'react'\nimport { ResolvedProperty } from '../state'\nimport registry from '../registry'\nimport { PropertyWidget } from './PropertyWidget'\n\nexport const PropertiesWidget = memo(({ properties }: { properties: ResolvedProperty[] }) => {\n    return (\n        <>\n            {properties.map(property => {\n                const propertyService = registry.propertyServices[property.type]\n                const hasCustomWidget = propertyService && 'widget' in propertyService\n\n                if (!hasCustomWidget) {\n                    return <PropertyWidget key={property.name} property={property} />\n                }\n\n                return createElement(propertyService.widget!, { property })\n            })}\n        </>\n    )\n})\n","import { ChangeEvent } from 'react'\nimport { PropertyService } from '../services_registry'\nimport { Input } from '../components/ui'\n\nexport type AnglePropertyOptions = {\n    name: string\n    defaultValue?: number\n    hasInput?: boolean\n    hasOutput?: boolean\n}\n\nexport type AngleProperty = {\n    value: number\n}\n\nexport const AnglePropertyService: PropertyService<\n    'angle',\n    AnglePropertyOptions,\n    AngleProperty,\n    number\n> = {\n    type: 'angle',\n    factory: ({\n        name,\n        defaultValue,\n        hasInput = false,\n        hasOutput = false,\n    }: AnglePropertyOptions) => {\n        return {\n            name,\n            type: 'angle',\n            value: defaultValue,\n            hasInput,\n            hasOutput,\n        }\n    },\n    serialize: property => {\n        // @ts-ignore\n        return property.value\n    },\n    getValue: data => {\n        return data.value\n    },\n    hydrate: (property, data) => {\n        return {\n            ...property,\n            value: data,\n        }\n    },\n    control: ({ property }) => {\n        const handleChange = (event: ChangeEvent<HTMLInputElement>) => {\n            console.log(event.target.value)\n        }\n\n        return <Input type=\"number\" value={property.value} onChange={handleChange} />\n    },\n}\n","export * from './ArrayStringPropertyService'\nexport * from './types'\n","import { ChangeEvent, Fragment } from 'react'\nimport styled from 'styled-components'\nimport { FiPlus } from 'react-icons/fi'\nimport { PropertyService } from '../services_registry'\nimport { Property, useStore } from '../state'\n\nexport type ArrayXYPropertyOptions = {\n    name: string\n    defaultValue?: {\n        x: number\n        y: number\n    }[]\n    hasInput?: boolean\n    hasOutput?: boolean\n}\n\nexport type ArrayXYProperty = {\n    value: {\n        x: number\n        y: number\n    }[]\n}\n\nconst ControlContainer = styled.div`\n    display: grid;\n    grid-template-columns: 20px auto 20px auto;\n    grid-row-gap: 6px;\n\n    input {\n        width: 52px;\n    }\n`\n\nconst ControlAddItemButton = styled.div`\n    grid-column-start: 1;\n    grid-column-end: 5;\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n\n    svg {\n        margin-right: 9px;\n    }\n`\n\nconst ArrayXYPropertyControl = ({ property }: { property: Property & ArrayXYProperty }) => {\n    const { updateProperty } = useStore()\n\n    const handleChange = (\n        itemIndex: number,\n        key: 'x' | 'y',\n        event: ChangeEvent<HTMLInputElement>\n    ) => {\n        updateProperty(property.id, {\n            value: property.value.map((item, index) => {\n                if (index !== itemIndex) {\n                    return item\n                }\n\n                return {\n                    ...item,\n                    [key]: Number(event.target.value),\n                }\n            }),\n        })\n    }\n\n    const handleAdd = () => {\n        updateProperty(property.id, {\n            value: [\n                ...property.value,\n                {\n                    x: 0,\n                    y: 0,\n                },\n            ],\n        })\n    }\n\n    return (\n        <ControlContainer>\n            {property.value.map((item, index) => {\n                return (\n                    <Fragment key={index}>\n                        x:{' '}\n                        <input\n                            type=\"number\"\n                            value={item.x}\n                            onChange={event => handleChange(index, 'x', event)}\n                            size={4}\n                        />\n                        y:{' '}\n                        <input\n                            type=\"number\"\n                            value={item.y}\n                            onChange={event => handleChange(index, 'y', event)}\n                        />\n                    </Fragment>\n                )\n            })}\n            <ControlAddItemButton onClick={handleAdd}>\n                <FiPlus /> Add item\n            </ControlAddItemButton>\n        </ControlContainer>\n    )\n}\n\nexport const ArrayXYPropertyService: PropertyService<\n    'array_xy',\n    ArrayXYPropertyOptions,\n    ArrayXYProperty,\n    {\n        x: number\n        y: number\n    }[]\n> = {\n    type: 'array_xy',\n    factory: ({\n        name,\n        defaultValue = [],\n        hasInput = false,\n        hasOutput = false,\n    }: ArrayXYPropertyOptions) => {\n        return {\n            name,\n            type: 'array_xy',\n            value: defaultValue,\n            hasInput,\n            hasOutput,\n        }\n    },\n    serialize: property => {\n        // @ts-ignore\n        return property.value\n    },\n    hydrate: (property, data) => {\n        return {\n            ...property,\n            value: data,\n        }\n    },\n    getValue: data => {\n        return data.value\n    },\n    control: ArrayXYPropertyControl,\n}\n","import { PropertyService } from '../services_registry'\nimport {\n    ChoicesPropertyOptions,\n    ChoiceProperty,\n    ChoicesPropertyService,\n    ChoicesPropertyControl,\n} from './ChoicesPropertyService'\n\nconst blendModeChoices = [\n    { label: 'normal', value: 'normal' },\n    { label: 'multiply', value: 'multiply' },\n    { label: 'screen', value: 'screen' },\n    { label: 'overlay', value: 'overlay' },\n    { label: 'darken', value: 'darken' },\n    { label: 'lighten', value: 'lighten' },\n    { label: 'color-dodge', value: 'color-dodge' },\n    { label: 'color-burn', value: 'color-burn' },\n    { label: 'hard-light', value: 'hard-light' },\n    { label: 'soft-light', value: 'soft-light' },\n    { label: 'difference', value: 'difference' },\n    { label: 'exclusion', value: 'exclusion' },\n    { label: 'hue', value: 'hue' },\n    { label: 'saturation', value: 'saturation' },\n    { label: 'color', value: 'color' },\n    { label: 'luminosity', value: 'luminosity' },\n]\n\nexport const BlendModePropertyService: PropertyService<\n    'blend_mode',\n    ChoicesPropertyOptions,\n    ChoiceProperty,\n    string | number\n> = {\n    type: 'blend_mode',\n    factory: ({ name, defaultValue, hasInput = false, hasOutput = false }: any) =>\n        ChoicesPropertyService.factory({\n            name,\n            defaultValue,\n            hasInput,\n            hasOutput,\n            choices: blendModeChoices,\n        }),\n    serialize: ChoicesPropertyService.serialize,\n    hydrate: (property, data) => {\n        return {\n            ...property,\n            value: data,\n            choices: blendModeChoices,\n        }\n    },\n    getValue: ChoicesPropertyService.getValue,\n    control: ChoicesPropertyControl,\n}\n","import { PropertyService } from '../services_registry'\nimport { createElement } from 'react'\n\nexport type CustomPropertyOptions = {\n    name: string\n    renderer: any\n}\n\nexport const CustomPropertyService: PropertyService<\n    'custom',\n    CustomPropertyOptions,\n    any,\n    undefined\n> = {\n    type: 'custom',\n    factory: ({ name, renderer }: CustomPropertyOptions) => {\n        return {\n            name,\n            renderer,\n            type: 'custom',\n            hasInput: false,\n            hasOutput: false,\n        }\n    },\n    serialize: () => undefined,\n    hydrate: property => property,\n    getValue: () => undefined,\n    widget: ({ property }) => {\n        return createElement(property.renderer, { property })\n    },\n}\n","export * from './MatrixPropertyService'\nexport * from './types'\n","export * from './NumberPropertyService'\nexport * from './types'\n","import { PropertyService } from '../services_registry'\n\nexport type RefPropertyOptions = {\n    name: string\n    hasInput?: boolean\n    hasOutput?: boolean\n}\n\nexport const RefPropertyService: PropertyService<'ref', RefPropertyOptions, any, any> = {\n    type: 'ref',\n    factory: ({ name, hasInput = false, hasOutput = false }: RefPropertyOptions) => {\n        return {\n            name,\n            type: 'ref',\n            hasInput,\n            hasOutput,\n        }\n    },\n    // refs are managed by links\n    serialize: () => undefined,\n    hydrate: property => property,\n    getValue: (property, registry) => {\n        return registry.resolvePropertyValue(property, undefined)\n    },\n}\n","import { PropertyService } from '../services_registry'\nimport { ChangeEvent } from 'react'\nimport { Property, useStore } from '../state'\nimport { Input } from '../components/ui'\n\nexport type TextPropertyOptions = {\n    name: string\n    defaultValue?: string\n    hasInput?: boolean\n    hasOutput?: boolean\n}\n\nexport type TextProperty = {\n    value: string\n}\n\nconst TextPropertyControl = ({ property }: { property: Property & TextProperty }) => {\n    const { updateProperty } = useStore()\n\n    const handleChange = (event: ChangeEvent<HTMLInputElement>) => {\n        updateProperty(property.id, {\n            value: event.target.value,\n        })\n    }\n\n    return <Input type=\"text\" value={property.value} onChange={handleChange} />\n}\n\nexport const TextPropertyService: PropertyService<\n    'text',\n    TextPropertyOptions,\n    TextProperty,\n    string\n> = {\n    type: 'text',\n    factory: ({\n        name,\n        defaultValue = '',\n        hasInput = false,\n        hasOutput = false,\n    }: TextPropertyOptions) => {\n        return {\n            name,\n            type: 'text',\n            value: defaultValue,\n            hasInput,\n            hasOutput,\n        }\n    },\n    serialize: property => {\n        // @ts-ignore\n        return property.value\n    },\n    hydrate: (property, data) => {\n        return {\n            ...property,\n            value: data,\n        }\n    },\n    getValue: data => {\n        return data.value\n    },\n    control: TextPropertyControl,\n}\n","import { ChangeEvent, Fragment, useCallback } from 'react'\nimport styled from 'styled-components'\nimport { FiPlus } from 'react-icons/fi'\nimport { FaTimes } from 'react-icons/fa'\nimport { Property, useStore } from '../../state'\nimport { Input } from '../../components/ui'\nimport { ArrayStringProperty } from './types'\n\nexport const ArrayStringPropertyControl = ({\n    property,\n}: {\n    property: Property & ArrayStringProperty\n}) => {\n    const { updateProperty } = useStore()\n\n    const setValue = useCallback(\n        (value: string[]) => {\n            updateProperty(property.id, { value })\n        },\n        [updateProperty, property.id]\n    )\n\n    const handleChange = (itemIndex: number, event: ChangeEvent<HTMLInputElement>) => {\n        setValue(\n            property.value.map((item, index) => {\n                if (index !== itemIndex) return item\n\n                return event.target.value\n            })\n        )\n    }\n\n    const handleAdd = () => {\n        setValue([...property.value, ''])\n    }\n\n    const handleRemove = (index: number) => {\n        setValue(property.value.filter((_, i) => i !== index))\n    }\n\n    return (\n        <>\n            <Grid>\n                {property.value.map((item, index) => {\n                    return (\n                        <Fragment key={index}>\n                            <span>[{index}]</span>\n                            <Input\n                                type=\"text\"\n                                value={item}\n                                onChange={event => handleChange(index, event)}\n                                size={4}\n                            />\n                            <RemoveButton\n                                onClick={() => {\n                                    handleRemove(index)\n                                }}\n                            >\n                                <FaTimes />\n                            </RemoveButton>\n                        </Fragment>\n                    )\n                })}\n                <AddItemButton onClick={handleAdd}>\n                    <FiPlus /> Add item\n                </AddItemButton>\n            </Grid>\n        </>\n    )\n}\n\nconst Grid = styled.div`\n    display: grid;\n    grid-template-columns: 28px 1fr 20px;\n    grid-column-gap: 6px;\n    grid-row-gap: 6px;\n    margin-bottom: 9px;\n    align-items: center;\n    font-size: 12px;\n`\n\nconst RemoveButton = styled.span`\n    width: 20px;\n    height: 20px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-size: 12px;\n    border-radius: 2px;\n    cursor: pointer;\n    color: #777777;\n\n    &:hover {\n        background-color: #333333;\n        color: ${props => props.theme.colors.accentColor};\n    }\n`\n\nconst AddItemButton = styled.div`\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n    grid-column-start: 2;\n\n    svg {\n        margin-right: 9px;\n    }\n`\n","import { PropertyService } from '../../services_registry'\nimport { ArrayStringPropertyOptions, ArrayStringProperty } from './types'\nimport { ArrayStringPropertyControl } from './ArrayStringPropertyControl'\n\nexport const ArrayStringPropertyService: PropertyService<\n    'array_string',\n    ArrayStringPropertyOptions,\n    ArrayStringProperty,\n    string[]\n> = {\n    type: 'array_string',\n    factory: ({\n        name,\n        defaultValue = [],\n        hasInput = false,\n        hasOutput = false,\n    }: ArrayStringPropertyOptions) => {\n        return {\n            name,\n            type: 'array_string',\n            value: defaultValue,\n            hasInput,\n            hasOutput,\n        }\n    },\n    serialize: property => {\n        // @ts-ignore\n        return property.value\n    },\n    hydrate: (property, data) => {\n        return {\n            ...property,\n            value: data || [],\n        }\n    },\n    getValue: data => {\n        return data.value\n    },\n    control: ArrayStringPropertyControl,\n}\n","import { ChangeEvent, Fragment } from 'react'\nimport styled from 'styled-components'\nimport { Property, useStore } from '../../state'\nimport { Input } from '../../components/ui'\nimport { MatrixProperty } from './types'\n\nexport const MatrixPropertyControl = ({ property }: { property: Property & MatrixProperty }) => {\n    const { updateProperty } = useStore()\n\n    const value = property.value\n\n    let xSize = 0\n    let ySize = 0\n    if (value.length > 0) {\n        ySize = value.length\n        if (Array.isArray(value[0])) {\n            xSize = value[0].length\n        }\n    }\n\n    const setValue = (valueUpdate: number[][]) => {\n        updateProperty(property.id, {\n            value: valueUpdate,\n        })\n    }\n\n    const handleSizeChange = (newXSize: number, newYSize: number) => {\n        let newValue = value.slice(0, newYSize)\n        for (let newRowIndex = 0; newRowIndex < newYSize - ySize; newRowIndex++) {\n            newValue.push(Array.from({ length: newXSize }).fill(0) as number[])\n        }\n        newValue = newValue.map(row => {\n            const newRow = row.slice(0, newXSize)\n            for (let newColumnIndex = 0; newColumnIndex < newXSize - xSize; newColumnIndex++) {\n                newRow.push(0)\n            }\n\n            return newRow\n        })\n\n        setValue(newValue)\n    }\n\n    const handleValueChange = (\n        targetRowIndex: number,\n        targetColumnIndex: number,\n        event: ChangeEvent<HTMLInputElement>\n    ) => {\n        setValue(\n            value.map((row, rowIndex) => {\n                if (targetRowIndex !== rowIndex) {\n                    return row\n                }\n\n                return row.map((cell, columnIndex) => {\n                    if (targetColumnIndex !== columnIndex) {\n                        return cell\n                    }\n\n                    return Number(event.target.value)\n                })\n            })\n        )\n    }\n\n    return (\n        <>\n            <SizeContainer>\n                x size\n                <Input\n                    type=\"number\"\n                    value={xSize}\n                    onChange={event => handleSizeChange(Number(event.target.value), ySize)}\n                />\n                y size\n                <Input\n                    type=\"number\"\n                    value={ySize}\n                    onChange={event => handleSizeChange(xSize, Number(event.target.value))}\n                />\n            </SizeContainer>\n            <MatrixWrapper>\n                <MatrixContainer columns={xSize} rows={ySize}>\n                    {value.map((row, rowIndex) => {\n                        return (\n                            <Fragment key={rowIndex}>\n                                {row.map((cell, columnIndex) => (\n                                    <Input\n                                        key={columnIndex}\n                                        type=\"number\"\n                                        value={cell}\n                                        onChange={event =>\n                                            handleValueChange(rowIndex, columnIndex, event)\n                                        }\n                                    />\n                                ))}\n                            </Fragment>\n                        )\n                    })}\n                </MatrixContainer>\n            </MatrixWrapper>\n        </>\n    )\n}\n\nconst SizeContainer = styled.div`\n    display: grid;\n    grid-template-columns: minmax(0, 1fr) minmax(0, 2fr) minmax(0, 1fr) minmax(0, 2fr);\n    grid-column-gap: 9px;\n    align-items: center;\n    font-size: 12px;\n    white-space: nowrap;\n    margin-bottom: 9px;\n`\n\nconst MatrixWrapper = styled.div`\n    overflow-x: scroll;\n`\n\nconst MatrixContainer = styled.div<{\n    columns: number\n    rows: number\n}>`\n    display: grid;\n    grid-template-columns: repeat(${props => props.columns}, minmax(50px, 1fr));\n    grid-template-rows: repeat(${props => props.rows}, 1fr);\n    grid-column-gap: 4px;\n    grid-row-gap: 4px;\n`\n","import { PropertyService } from '../../services_registry'\nimport { MatrixPropertyOptions, MatrixProperty } from './types'\nimport { MatrixPropertyControl } from './MatrixPropertyControl'\n\nexport const MatrixPropertyService: PropertyService<\n    'matrix',\n    MatrixPropertyOptions,\n    MatrixProperty,\n    number[][]\n> = {\n    type: 'matrix',\n    factory: ({\n        name,\n        defaultValue = [],\n        hasInput = false,\n        hasOutput = false,\n    }: MatrixPropertyOptions) => {\n        return {\n            name,\n            type: 'matrix',\n            value: defaultValue,\n            hasInput,\n            hasOutput,\n        }\n    },\n    serialize: property => {\n        // @ts-ignore\n        return property.value\n    },\n    hydrate: (property, data) => {\n        return {\n            ...property,\n            value: data,\n        }\n    },\n    getValue: data => {\n        return data.value\n    },\n    control: MatrixPropertyControl,\n}\n","import { PropertyService } from '../../services_registry'\nimport { NumberPropertyOptions, NumberProperty } from './types'\nimport { NumberPropertyControl } from './NumberPropertyControl'\n\nexport const NumberPropertyService: PropertyService<\n    'number',\n    NumberPropertyOptions,\n    NumberProperty,\n    number\n> = {\n    type: 'number',\n    factory: ({\n        name,\n        defaultValue = 0,\n        hasInput = false,\n        hasOutput = false,\n        options: partialOptions = {},\n    }: NumberPropertyOptions) => {\n        const options = {\n            controlType: partialOptions.controlType || 'number',\n            min: partialOptions.min !== undefined ? partialOptions.min : undefined,\n            max: partialOptions.max !== undefined ? partialOptions.max : undefined,\n            step: partialOptions.step || 1,\n        }\n\n        return {\n            name,\n            type: 'number',\n            value: defaultValue,\n            hasInput,\n            hasOutput,\n            options,\n        }\n    },\n    serialize: property => {\n        // @ts-ignore\n        return property.value\n    },\n    hydrate: (property, data) => {\n        return {\n            ...property,\n            value: data,\n        }\n    },\n    getValue: (property: any, registry) => {\n        return registry.resolvePropertyValue(property, property.value)\n    },\n    control: NumberPropertyControl,\n}\n","import { ChangeEvent } from 'react'\nimport { Property, useStore } from '../../state'\nimport { Input } from '../../components/ui'\nimport { NumberProperty, NumberPropertyOptions } from './types'\n\nexport const NumberPropertyControl = ({ property }: { property: Property & NumberProperty }) => {\n    const { updateProperty } = useStore()\n\n    const options: NumberPropertyOptions['options'] = (property as any).options\n\n    const handleChange = (event: ChangeEvent<HTMLInputElement>) => {\n        updateProperty(property.id, {\n            value: Number(event.target.value),\n        })\n    }\n\n    if (options!.controlType === 'number') {\n        return (\n            <Input\n                type=\"number\"\n                value={property.value}\n                onChange={handleChange}\n                min={options!.min}\n                max={options!.max}\n                step={options!.step}\n            />\n        )\n    }\n\n    return (\n        <Input\n            type=\"range\"\n            value={property.value}\n            onChange={handleChange}\n            min={options!.min}\n            max={options!.max}\n            step={options!.step}\n        />\n    )\n}\n","import { groupBy, sortBy } from 'lodash'\nimport { CreateProperty, Property, ResolvedNode, ResolvedProperty } from './state'\n\nexport interface NodeService<Type extends string, Data> {\n    type: Type\n    category: string\n    description?: string\n    hasOutput: boolean\n    properties: CreateProperty[]\n    factory: (data?: Partial<Data>) => Data\n    getValue: (node: ResolvedNode, registry: ServiceRegistry) => any\n    widget?: (props: { node: ResolvedNode; registry: ServiceRegistry }) => JSX.Element\n}\n\nexport interface PropertyService<\n    Type extends string,\n    Options,\n    PropertyData = never,\n    Value = never\n> {\n    type: Type\n    factory: (options: Options) => CreateProperty\n    serialize: (property: ResolvedProperty) => any\n    hydrate: (property: Property, data: any) => Property\n    getValue: (property: PropertyData, registry: ServiceRegistry) => Value\n    widget?: (props: { property: Property & PropertyData }) => JSX.Element\n    control?: (props: { property: Property & PropertyData }) => JSX.Element\n}\n\nexport class ServiceRegistry {\n    nodeServices: Record<string, NodeService<string, any>>\n    propertyServices: Record<string, PropertyService<string, any, any, any>>\n\n    constructor() {\n        this.nodeServices = {}\n        this.propertyServices = {}\n    }\n\n    registerNodeService(nodeService: NodeService<string, any>) {\n        this.nodeServices[nodeService.type] = nodeService\n\n        return this\n    }\n\n    getNodeService(nodeType: string): NodeService<string, any> {\n        const nodeService = this.nodeServices[nodeType]\n        if (!nodeService) {\n            throw new Error(`no node service defined for: ${nodeType}`)\n        }\n\n        return nodeService\n    }\n\n    getNodeServiceCategories() {\n        const grouped = Object.entries(groupBy(this.nodeServices, 'category'))\n        const sorted = sortBy(grouped, group => group[0])\n\n        return sorted.map(group => ({\n            category: group[0],\n            types: sortBy(group[1], 'type'),\n        }))\n    }\n\n    registerPropertyService(propertyService: PropertyService<any, any, any, any>) {\n        this.propertyServices[propertyService.type] = propertyService\n\n        return this\n    }\n\n    getPropertyService(propertyType: string): PropertyService<any, any, any, any> {\n        const propertyService = this.propertyServices[propertyType]\n        if (!propertyService) {\n            throw new Error(`no property service defined for: ${propertyType}`)\n        }\n\n        return propertyService\n    }\n\n    resolvePropertyValue(property: ResolvedProperty, ownValue?: any) {\n        const { input } = property\n        if (!input) {\n            return ownValue\n        }\n\n        if (input.elementType === 'property') {\n            return this.getPropertyService(input.type).getValue(input, this)\n        }\n\n        if (input.elementType === 'node') {\n            return this.getNodeService(input.type).getValue(input, this)\n        }\n    }\n}\n","import { AreaBump } from '@nivo/bump'\nimport { NodeService } from '../services_registry'\n\nexport interface AreaBumpNodeData {\n    data?: any\n    width: number\n    height: number\n    margin?: any\n    spacing: number\n    xPadding: number\n    colors?: any\n    blendMode?: string\n    borderColor?: any\n    axisTop?: any\n    axisBottom?: any\n}\n\nexport const AreaBumpNodeService: NodeService<'area_bump', AreaBumpNodeData> = {\n    type: 'area_bump',\n    category: 'charts',\n    description: `An AreaBump chart from @nivo/bump package.`,\n    hasOutput: true,\n    properties: [\n        {\n            type: 'ref',\n            name: 'data',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'width',\n            hasInput: true,\n            hasOutput: true,\n        },\n        {\n            type: 'number',\n            name: 'height',\n            hasInput: true,\n            hasOutput: true,\n        },\n        {\n            type: 'ref',\n            name: 'margin',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'spacing',\n        },\n        {\n            type: 'number',\n            name: 'xPadding',\n        },\n        {\n            type: 'ref',\n            name: 'theme',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'colors',\n            hasInput: true,\n        },\n        {\n            type: 'blend_mode',\n            name: 'blendMode',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'borderColor',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisTop',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisBottom',\n            hasInput: true,\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            width: data?.width ?? 420,\n            height: data?.height ?? 240,\n            spacing: data?.spacing ?? 3,\n            xPadding: data?.xPadding ?? 0.6,\n        }\n    },\n    getValue: ({ properties }, registry) => {\n        const value: any = {}\n        properties.forEach(property => {\n            value[property.name] = registry\n                .getPropertyService(property.type)\n                .getValue(property, registry)\n        })\n\n        return <AreaBump {...value} isInteractive={false} />\n    },\n}\n","import { keyBy } from 'lodash'\nimport { NodeService } from '../services_registry'\n\nexport interface AxisNodeData {\n    tickSize: number\n    tickPadding: number\n    tickRotation: number\n    legend?: string\n    legendOffset: number\n}\n\nexport const AxisNodeService: NodeService<'axis', AxisNodeData> = {\n    type: 'axis',\n    category: 'axis_grid',\n    description: `X or Y axis to be used in various chart types.`,\n    hasOutput: true,\n    properties: [\n        {\n            type: 'number',\n            name: 'tickSize',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'tickPadding',\n            hasInput: true,\n        },\n        {\n            type: 'angle',\n            name: 'tickRotation',\n            hasInput: true,\n        },\n        {\n            type: 'text',\n            name: 'legend',\n        },\n        {\n            type: 'number',\n            name: 'legendOffset',\n            hasInput: true,\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            tickSize: data?.tickSize ?? 5,\n            tickPadding: data?.tickPadding ?? 5,\n            tickRotation: data?.tickRotation ?? 0,\n            legend: data?.legend,\n            legendOffset: data?.legendOffset ?? 0,\n        }\n    },\n    getValue: ({ properties }) => {\n        const propertyValues: any = keyBy(properties, 'name')\n\n        const nodeValue: any = {\n            tickSize: propertyValues.tickSize.value,\n            tickPadding: propertyValues.tickPadding.value,\n            tickRotation: propertyValues.tickRotation.value,\n            legendOffset: propertyValues.legendOffset.value,\n        }\n\n        if (propertyValues.legend.value) {\n            nodeValue.legend = propertyValues.legend.value\n        }\n\n        return nodeValue\n    },\n}\n","import { NodeService } from '../services_registry'\n\nexport interface BlendModeNodeData {\n    blendMode: string\n}\n\nexport const BlendModeNodeService: NodeService<'blend_mode', BlendModeNodeData> = {\n    type: 'blend_mode',\n    category: 'colors',\n    hasOutput: true,\n    properties: [\n        {\n            type: 'blend_mode',\n            name: 'blendMode',\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            blendMode: data?.blendMode ?? 'normal',\n        }\n    },\n    getValue: node => {\n        return (node.properties[0] as any).value\n    },\n}\n","import { ResolvedNode } from '../state'\nimport { NodeService, ServiceRegistry } from '../services_registry'\nimport { PropertiesWidget } from '../components/PropertiesWidget'\n\nconst CanvasNodeWidget = ({\n    node,\n    registry,\n}: {\n    node: ResolvedNode\n    registry: ServiceRegistry\n}) => {\n    const props: any = {}\n    node.properties.forEach(property => {\n        props[property.name] = registry\n            .getPropertyService(property.type)\n            .getValue(property, registry)\n    })\n\n    return (\n        <>\n            <PropertiesWidget properties={node.properties} />\n            <div\n                style={{\n                    width: props.width,\n                    height: props.height,\n                    backgroundColor: '#000000',\n                    overflow: 'hidden',\n                }}\n            >\n                {props.content}\n            </div>\n        </>\n    )\n}\n\nexport interface CanvasNodeData {\n    content?: any\n    width: number\n    height: number\n}\n\nexport const CanvasNodeService: NodeService<'canvas', CanvasNodeData> = {\n    type: 'canvas',\n    category: 'render',\n    description: `A canvas to render a React node.`,\n    hasOutput: false,\n    properties: [\n        {\n            type: 'ref',\n            name: 'content',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'width',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'height',\n            hasInput: true,\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            content: undefined,\n            width: data?.width ?? 300,\n            height: data?.height ?? 240,\n        }\n    },\n    getValue: () => ({}),\n    widget: CanvasNodeWidget,\n}\n","import { Chord } from '@nivo/chord'\nimport { NodeService } from '../services_registry'\n\nexport interface ChordNodeData {\n    matrix?: any\n    keys?: any\n    width: number\n    height: number\n    margin?: any\n    innerRadiusRatio: number\n    innerRadiusOffset: number\n    theme?: any\n    colors?: any\n}\n\nexport const ChordNodeService: NodeService<'chord', ChordNodeData> = {\n    type: 'chord',\n    category: 'charts',\n    description: `An Chord diagram from @nivo/chord package.`,\n    hasOutput: true,\n    properties: [\n        {\n            type: 'ref',\n            name: 'matrix',\n            hasInput: true,\n        },\n        {\n            type: 'array_string',\n            name: 'keys',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'width',\n            hasInput: true,\n            hasOutput: true,\n        },\n        {\n            type: 'number',\n            name: 'height',\n            hasInput: true,\n            hasOutput: true,\n        },\n        {\n            type: 'ref',\n            name: 'margin',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'innerRadiusRatio',\n            options: {\n                controlType: 'range',\n                min: 0,\n                max: 1,\n                step: 0.01,\n            },\n        } as any,\n        {\n            type: 'number',\n            name: 'innerRadiusOffset',\n            options: {\n                controlType: 'range',\n                min: 0,\n                max: 1,\n                step: 0.01,\n            },\n        } as any,\n        {\n            type: 'ref',\n            name: 'theme',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'colors',\n            hasInput: true,\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            keys: data?.keys ?? [],\n            width: data?.width ?? 420,\n            height: data?.height ?? 240,\n            innerRadiusRatio: data?.innerRadiusRatio ?? 0.9,\n            innerRadiusOffset: data?.innerRadiusOffset ?? 0,\n        }\n    },\n    getValue: ({ properties }, registry) => {\n        const value: any = {}\n        properties.forEach(property => {\n            value[property.name] = registry\n                .getPropertyService(property.type)\n                .getValue(property, registry)\n        })\n\n        // check if the chart can be rendered\n        if (!Array.isArray(value.matrix) || !Array.isArray(value.keys)) {\n            return <div />\n        }\n\n        return <Chord {...value} isInteractive={true} />\n    },\n}\n","import { NodeService } from '../services_registry'\n\nconst schemeChoices = [\n    { label: 'nivo', value: 'nivo' },\n    { label: 'Category 10', value: 'category10' },\n    { label: 'Accent', value: 'accent' },\n    { label: 'Dark 2', value: 'dark2' },\n    { label: 'Paired', value: 'paired' },\n    { label: 'Pastel 1', value: 'pastel1' },\n    { label: 'Pastel 2', value: 'pastel2' },\n    { label: 'Set 1', value: 'set1' },\n    { label: 'Set 2', value: 'set2' },\n    { label: 'Set 3', value: 'set3' },\n    { label: 'Brown - Blue Green', value: 'brown_blueGreen' },\n    { label: 'Purple Red - Green', value: 'purpleRed_green' },\n    { label: 'Pink - Yellow Green', value: 'pink_yellowGreen' },\n    { label: 'Purple - Orange', value: 'purple_orange' },\n    { label: 'Red - Blue', value: 'red_blue' },\n    { label: 'Red - Grey', value: 'red_grey' },\n    { label: 'Red - Yellow - Blue', value: 'red_yellow_blue' },\n    { label: 'Red - Yellow - Green', value: 'red_yellow_green' },\n    { label: 'Spectral', value: 'spectral' },\n]\n\nexport interface ColorSchemeNodeData {\n    scheme: string\n}\n\nexport const ColorSchemeNodeService: NodeService<'color_scheme', ColorSchemeNodeData> = {\n    type: 'color_scheme',\n    category: 'colors',\n    description: `A predefined color scheme to be used with nivo charts.`,\n    hasOutput: true,\n    properties: [\n        {\n            type: 'choices',\n            name: 'scheme',\n            choices: schemeChoices,\n        } as any,\n    ],\n    factory: (data = {}) => {\n        return {\n            scheme: data?.scheme ?? 'nivo',\n        }\n    },\n    getValue: node => {\n        const schemeProperty = node.properties.find(property => property.name === 'scheme') as any\n\n        return {\n            scheme: schemeProperty.value,\n        }\n    },\n}\n","import { Line } from '@nivo/line'\nimport { NodeService } from '../services_registry'\n\nexport interface LineNodeData {\n    data?: any\n    width: number\n    height: number\n    margin?: number\n    colors?: any\n    axisTop?: any\n    axisRight?: any\n    axisBottom?: any\n    axisLeft?: any\n}\n\nexport const LineNodeService: NodeService<'line', LineNodeData> = {\n    type: 'line',\n    category: 'charts',\n    description: `A Line chart from @nivo/line package.`,\n    hasOutput: true,\n    properties: [\n        {\n            type: 'ref',\n            name: 'data',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'width',\n            hasInput: true,\n            hasOutput: true,\n        },\n        {\n            type: 'number',\n            name: 'height',\n            hasInput: true,\n            hasOutput: true,\n        },\n        {\n            type: 'ref',\n            name: 'margin',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'theme',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'colors',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisTop',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisRight',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisBottom',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisLeft',\n            hasInput: true,\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            width: data?.width ?? 420,\n            height: data?.height ?? 240,\n        }\n    },\n    getValue: ({ properties }, registry) => {\n        const value: any = {}\n        properties.forEach(property => {\n            value[property.name] = registry\n                .getPropertyService(property.type)\n                .getValue(property, registry)\n        })\n\n        return <Line {...value} isInteractive={false} />\n    },\n}\n","import { NodeService } from '../services_registry'\n\nexport interface MarginNodeData {\n    top: number\n    right: number\n    bottom: number\n    left: number\n}\n\nexport const MarginNodeService: NodeService<'margin', MarginNodeData> = {\n    type: 'margin',\n    category: 'dimensions',\n    description: `Top/right/bottom/left margins for charts.`,\n    hasOutput: true,\n    properties: [\n        {\n            type: 'number',\n            name: 'top',\n        },\n        {\n            type: 'number',\n            name: 'right',\n        },\n        {\n            type: 'number',\n            name: 'bottom',\n        },\n        {\n            type: 'number',\n            name: 'left',\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            top: data?.top ?? 0,\n            right: data?.right ?? 0,\n            bottom: data?.bottom ?? 0,\n            left: data?.left ?? 0,\n        }\n    },\n    getValue: ({ properties }, registry) => {\n        const value: any = {}\n        properties.forEach(property => {\n            value[property.name] = registry\n                .getPropertyService(property.type)\n                .getValue(property, registry)\n        })\n\n        return value\n    },\n}\n","import { ScatterPlot } from '@nivo/scatterplot'\nimport { NodeService } from '../services_registry'\n\nexport interface ScatterPlotNodeData {\n    data?: any\n    width: number\n    height: number\n    margin?: any\n    colors?: any\n    borderColor?: any\n    axisTop?: any\n    axisRight?: any\n    axisBottom?: any\n    axisLeft?: any\n}\n\nexport const ScatterPlotNodeService: NodeService<'scatterplot', ScatterPlotNodeData> = {\n    type: 'scatterplot',\n    category: 'charts',\n    description: `A ScatterPlot chart from @nivo/scatterplot package.`,\n    hasOutput: true,\n    properties: [\n        {\n            type: 'ref',\n            name: 'data',\n            hasInput: true,\n        },\n        {\n            type: 'number',\n            name: 'width',\n            hasInput: true,\n            hasOutput: true,\n        },\n        {\n            type: 'number',\n            name: 'height',\n            hasInput: true,\n            hasOutput: true,\n        },\n        {\n            type: 'ref',\n            name: 'margin',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'theme',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'colors',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'borderColor',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisTop',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisRight',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisBottom',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'axisLeft',\n            hasInput: true,\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            width: data?.width ?? 420,\n            height: data?.height ?? 240,\n        }\n    },\n    getValue: ({ properties }, registry) => {\n        const value: any = {}\n        properties.forEach(property => {\n            value[property.name] = registry\n                .getPropertyService(property.type)\n                .getValue(property, registry)\n        })\n\n        return <ScatterPlot {...value} isInteractive={false} />\n    },\n}\n","import { NodeService } from '../services_registry'\n\nconst SeriesXYNodeWidget = () => {\n    return <div>Custom</div>\n}\n\nexport const SeriesXYNodeService: NodeService<'series_xy', any> = {\n    type: 'series_xy',\n    category: 'data',\n    hasOutput: true,\n    properties: [\n        {\n            type: 'ref',\n            name: 'serie_0',\n            hasInput: true,\n        },\n        {\n            type: 'ref',\n            name: 'serie_1',\n            hasInput: true,\n        },\n    ],\n    factory: () => {\n        return {}\n    },\n    widget: SeriesXYNodeWidget,\n    getValue: (node, registry) => {\n        return node.properties.map(property => {\n            const propertyService = registry.getPropertyService(property.type)\n\n            return propertyService.getValue(property, registry)\n        })\n    },\n}\n","import { keyBy } from 'lodash'\nimport { NodeService } from '../services_registry'\n\nexport interface SerieXYNodeData {\n    id: string\n    data: {\n        x: number\n        y: number\n    }[]\n}\n\nexport const SerieXYNodeService: NodeService<'serie_xy', SerieXYNodeData> = {\n    type: 'serie_xy',\n    category: 'data',\n    hasOutput: true,\n    properties: [\n        {\n            type: 'text',\n            name: 'id',\n        },\n        {\n            type: 'array_xy',\n            name: 'data',\n        },\n    ],\n    factory: (data = {}) => {\n        return {\n            id: data?.id ?? '',\n            data: data?.data ?? [],\n        }\n    },\n    getValue: ({ properties }) => {\n        const propertyValues: any = keyBy(properties, 'name')\n\n        return {\n            id: propertyValues.id.value,\n            data: propertyValues.data.value,\n        }\n    },\n}\n","import { ServiceRegistry } from './services_registry'\nimport {\n    AreaBumpNodeService,\n    AxisNodeService,\n    BlendModeNodeService,\n    CanvasNodeService,\n    ChordNodeService,\n    ColorSchemeNodeService,\n    LineNodeService,\n    MarginNodeService,\n    MatrixNodeService,\n    NivoThemeNodeService,\n    ScatterPlotNodeService,\n    SerieXYNodeService,\n    SeriesXYNodeService,\n} from './node_services'\nimport {\n    AnglePropertyService,\n    ArrayStringPropertyService,\n    ArrayXYPropertyService,\n    BlendModePropertyService,\n    ChoicesPropertyService,\n    CustomPropertyService,\n    MatrixPropertyService,\n    NumberPropertyService,\n    RefPropertyService,\n    TextPropertyService,\n} from './property_services'\n\nconst servicesRegistry = new ServiceRegistry()\n\nservicesRegistry\n    .registerNodeService(AreaBumpNodeService)\n    .registerNodeService(AxisNodeService)\n    .registerNodeService(BlendModeNodeService)\n    .registerNodeService(CanvasNodeService)\n    .registerNodeService(ChordNodeService)\n    .registerNodeService(ColorSchemeNodeService)\n    .registerNodeService(LineNodeService)\n    .registerNodeService(MarginNodeService)\n    .registerNodeService(MatrixNodeService)\n    .registerNodeService(NivoThemeNodeService)\n    .registerNodeService(ScatterPlotNodeService)\n    .registerNodeService(SerieXYNodeService)\n    .registerNodeService(SeriesXYNodeService)\n\nservicesRegistry\n    .registerPropertyService(AnglePropertyService)\n    .registerPropertyService(ArrayStringPropertyService)\n    .registerPropertyService(ArrayXYPropertyService)\n    .registerPropertyService(BlendModePropertyService)\n    .registerPropertyService(ChoicesPropertyService)\n    .registerPropertyService(CustomPropertyService)\n    .registerPropertyService(MatrixPropertyService)\n    .registerPropertyService(NumberPropertyService)\n    .registerPropertyService(RefPropertyService)\n    .registerPropertyService(TextPropertyService)\n\nexport default servicesRegistry\n","import { NodeService } from '../services_registry'\n\nexport interface MatrixNodeData {\n    data: number[][]\n}\n\nexport const MatrixNodeService: NodeService<'matrix', MatrixNodeData> = {\n    type: 'matrix',\n    category: 'data',\n    hasOutput: true,\n    properties: [\n        {\n            type: 'matrix',\n            name: 'matrix',\n        },\n    ],\n    factory: data => {\n        return {\n            data: data?.data || [],\n        }\n    },\n    getValue: ({ properties }, registry) => {\n        const value: any = {}\n        properties.forEach(property => {\n            value[property.name] = registry\n                .getPropertyService(property.type)\n                .getValue(property, registry)\n        })\n\n        return value.matrix || []\n    },\n}\n","import { NodeService } from '../services_registry'\n\nexport const NivoThemeNodeService: NodeService<'nivo_theme', {}> = {\n    type: 'nivo_theme',\n    category: 'theming',\n    description: `A theme object to be used with nivo charts.`,\n    hasOutput: true,\n    properties: [],\n    factory: () => {\n        return {}\n    },\n    getValue: () => {\n        return {\n            fontFamily: `'IBM Plex Mono', monospace`,\n            fontSize: 11,\n            textColor: '#dddddd',\n            grid: {\n                line: {\n                    stroke: '#333333',\n                },\n            },\n            tooltip: {\n                container: {\n                    background: '#222222',\n                    color: 'inherit',\n                    fontSize: 'inherit',\n                    borderRadius: '2px',\n                    boxShadow: '0 1px 2px rgba(0, 0, 0, 0.25)',\n                    padding: '5px 9px',\n                },\n            },\n        }\n    },\n}\n","import styled from 'styled-components'\n\nexport const Input = styled.input`\n    border: none;\n    padding: 3px 6px;\n    border-radius: 2px;\n    font-family: inherit;\n    background-color: ${props => props.theme.colors.inputBackground};\n    color: ${props => props.theme.colors.inputText};\n    font-size: 12px;\n    cursor: pointer;\n\n    &:focus {\n        outline: 0;\n        background-color: #bbbbbb;\n        color: #000000;\n        cursor: auto;\n    }\n`\n","import { createGlobalStyle } from 'styled-components'\n\nexport const GlobalStyle = createGlobalStyle`\n    body {\n        margin: 0;\n        font-family: 'IBM Plex Mono', monospace;\n        -webkit-font-smoothing: antialiased;\n        -moz-osx-font-smoothing: grayscale;\n        font-size: 14px;\n        color: ${props => props.theme.colors.text};\n    }\n    \n    code {\n        font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New', monospace;\n    }\n    \n    * {\n        box-sizing: border-box;\n    }\n    \n    .App {\n        position: fixed;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n    }\n`\n","import { darkTheme } from './darkTheme'\nimport { lightTheme } from './lightTheme'\n\nexport const themes = [\n    {\n        id: 'dark',\n        name: 'Dark theme',\n        theme: darkTheme,\n    },\n    {\n        id: 'light',\n        name: 'Light theme',\n        theme: lightTheme,\n    },\n]\n","import { DefaultTheme } from 'styled-components'\nimport { transparentize } from 'polished'\n\nexport const darkTheme: DefaultTheme = {\n    colors: {\n        background: '#292929',\n        mediumDepthBackground: '#111111',\n        topDepthBackground: '#000000',\n        badgeBackground: '#333333',\n        inputBackground: '#333333',\n        inputText: '#eeeeee',\n        text: '#eeeeee',\n        accentColor: 'pink',\n        border: '#555555',\n        lightBorder: '#333333',\n        nodeBorder: '#111111',\n        success: '#65f7cf',\n        overlay: transparentize(0.2, '#333333'),\n    },\n}\n","import { DefaultTheme } from 'styled-components'\nimport { transparentize } from 'polished'\n\nexport const lightTheme: DefaultTheme = {\n    colors: {\n        background: '#ececec',\n        mediumDepthBackground: '#f5f3f3',\n        topDepthBackground: '#ffffff',\n        badgeBackground: '#eeeeee',\n        inputBackground: '#eeeeee',\n        inputText: '#444444',\n        text: '#333333',\n        accentColor: '#1a8cc3',\n        border: '#dddddd',\n        lightBorder: '#eeeeee',\n        nodeBorder: '#cccccc',\n        success: '#0ab537',\n        overlay: transparentize(0.3, '#eeeeee'),\n    },\n}\n","import styled from 'styled-components'\nimport { useStore } from '../state'\n\nexport const AppFooter = () => {\n    const { linking } = useStore()\n\n    return (\n        <Container>\n            {linking.isLinking && (\n                <div>\n                    from: {linking.anchor[0]},{linking.anchor[1]}\n                    to: {linking.position[0]},{linking.position[1]}\n                    potential ID: {linking.potentialId}\n                </div>\n            )}\n        </Container>\n    )\n}\n\nconst Container = styled.footer`\n    position: fixed;\n    left: 64px;\n    bottom: 0;\n    width: calc(100% - 364px);\n    height: 36px;\n    background-color: ${props => props.theme.colors.mediumDepthBackground};\n`\n","import styled from 'styled-components'\n\nexport const AppHeader = () => {\n    return <Header>{/*<Title>nivo graph editor</Title>*/}</Header>\n}\n\nconst Header = styled.header`\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 46px;\n    background-color: ${props => props.theme.colors.mediumDepthBackground};\n    display: flex;\n    align-items: center;\n    padding-left: 64px;\n`\n\n/*\nconst Title = styled.h1`\n    margin: 0;\n    padding: 0;\n    font-size: 14px;\n    color: ${props => props.theme.colors.accentColor};\n    text-transform: uppercase;\n`\n*/\n","import styled from 'styled-components'\nimport { FaChevronRight, FaCheck } from 'react-icons/fa'\nimport { useStore } from '../state'\nimport { ReactNode } from 'react'\n\nconst ICON_SIZE = 24\nconst ICON_SPACING = 16\n\nexport const LinkingLayer = () => {\n    const { linking } = useStore()\n\n    if (!linking.isLinking) {\n        return null\n    }\n\n    let iconPosition: [number, number]\n    if (linking.type === 'source') {\n        iconPosition = [linking.position[0] + ICON_SPACING, linking.position[1] - ICON_SIZE / 2]\n    } else {\n        iconPosition = [\n            linking.position[0] - ICON_SIZE - ICON_SPACING,\n            linking.position[1] - ICON_SIZE / 2,\n        ]\n    }\n\n    let icon: ReactNode = <FaChevronRight />\n    if (linking.potentialId) {\n        icon = <FaCheck />\n    }\n\n    return (\n        <svg\n            style={{\n                position: 'absolute',\n                width: '100%',\n                height: '100%',\n                pointerEvents: 'none',\n            }}\n        >\n            <Line\n                strokeLinecap=\"round\"\n                x1={linking.anchor[0]}\n                x2={linking.position[0]}\n                y1={linking.anchor[1]}\n                y2={linking.position[1]}\n            />\n            <Circle cx={linking.position[0]} cy={linking.position[1]} r={4} />\n            <foreignObject x={iconPosition[0]} y={iconPosition[1]} width={24} height={24}>\n                <Icon isValid={!!linking.potentialId}>{icon}</Icon>\n            </foreignObject>\n        </svg>\n    )\n}\n\nconst Line = styled.line`\n    stroke-width: 3px;\n    stroke: ${props => props.theme.colors.accentColor};\n`\n\nconst Circle = styled.circle`\n    fill: ${props => props.theme.colors.accentColor};\n`\n\nconst Icon = styled.div<{\n    isValid: boolean\n}>`\n    width: ${ICON_SIZE}px;\n    height: ${ICON_SIZE}px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: ${props => props.theme.colors.topDepthBackground};\n    color: ${props =>\n        props.isValid ? props.theme.colors.success : props.theme.colors.accentColor};\n    border: 2px solid\n        ${props => (props.isValid ? props.theme.colors.success : props.theme.colors.accentColor)};\n    border-radius: ${ICON_SIZE / 2}px;\n    font-size: 12px;\n`\n","import { useCallback, useMemo, useState } from 'react'\nimport styled from 'styled-components'\nimport { line as d3Line, curveBasis } from 'd3-shape'\nimport { FaTimes } from 'react-icons/fa'\nimport { ResolvedLink, useStore } from '../state'\n\nconst lineGenerator = d3Line().curve(curveBasis)\n\nconst UNLINK_BUTTON_SIZE = 18\n\nexport const LinkWidget = ({ link }: { link: ResolvedLink }) => {\n    const { source, target } = link\n\n    const sourceElementType = source.elementType\n\n    const sourceX = source.x\n    const sourceY = source.y\n    const sourceWidth = source.width\n    const sourceHeight = source.height\n\n    const targetX = target.x\n    const targetY = target.y\n    const targetHeight = target.height\n\n    const [path, center] = useMemo(() => {\n        if (\n            sourceX === undefined ||\n            sourceY === undefined ||\n            sourceWidth === undefined ||\n            sourceHeight === undefined ||\n            targetX === undefined ||\n            targetY === undefined ||\n            targetHeight === undefined\n        ) {\n            return [null, null]\n        }\n\n        const sourcePosition: [number, number] = [\n            sourceX + sourceWidth,\n            sourceY + (sourceElementType === 'property' ? sourceHeight / 2 : 12),\n        ]\n        const targetPosition: [number, number] = [targetX, targetY + targetHeight / 2]\n\n        const xDistance = targetPosition[0] - sourcePosition[0]\n        const yDistance = targetPosition[1] - sourcePosition[1]\n\n        const center: [number, number] = [\n            sourcePosition[0] + xDistance / 2,\n            sourcePosition[1] + yDistance / 2,\n        ]\n\n        const xOffset = Math.max(6, Math.min(42, Math.abs(xDistance) * 0.2))\n\n        const points: [number, number][] = [sourcePosition]\n        points.push([sourcePosition[0] + xOffset, sourcePosition[1]])\n        points.push(center)\n        points.push([targetPosition[0] - xOffset, targetPosition[1]])\n        points.push(targetPosition)\n\n        return [lineGenerator(points), center]\n    }, [\n        sourceElementType,\n        sourceX,\n        sourceY,\n        sourceWidth,\n        sourceHeight,\n        targetX,\n        targetY,\n        targetHeight,\n    ])\n\n    const [isHover, setIsHover] = useState(false)\n    const handleHover = useCallback(() => {\n        setIsHover(true)\n    }, [setIsHover])\n    const handleOut = useCallback(() => {\n        setIsHover(false)\n    }, [setIsHover])\n\n    const { unlink } = useStore()\n    const sourceId = source.id\n    const targetId = target.id\n    const handleUnlink = useCallback(() => {\n        unlink(sourceId, targetId)\n    }, [unlink, sourceId, targetId])\n\n    if (!path || !center) {\n        return null\n    }\n\n    return (\n        <>\n            <Path d={path} isHover={isHover} />\n            {!isHover && <Circle cx={center[0]} cy={center[1]} r={4} />}\n            <CapturePath d={path} onMouseEnter={handleHover} onMouseLeave={handleOut} />\n            {isHover && (\n                <foreignObject\n                    x={center[0] - UNLINK_BUTTON_SIZE / 2}\n                    y={center[1] - UNLINK_BUTTON_SIZE / 2}\n                    width={UNLINK_BUTTON_SIZE}\n                    height={UNLINK_BUTTON_SIZE}\n                >\n                    <UnlinkButton\n                        onMouseEnter={handleHover}\n                        onMouseLeave={handleOut}\n                        onClick={handleUnlink}\n                    >\n                        <FaTimes />\n                    </UnlinkButton>\n                </foreignObject>\n            )}\n        </>\n    )\n}\n\nconst CapturePath = styled.path`\n    pointer-events: all;\n    fill: none;\n    stroke: rgba(255, 255, 255, 0);\n    stroke-width: 8px;\n`\n\nconst Path = styled.path<{\n    isHover: boolean\n}>`\n    fill: none;\n    stroke: ${props => props.theme.colors.accentColor};\n    stroke-width: ${props => (props.isHover ? 4 : 2)}px;\n`\n\nconst UnlinkButton = styled.div`\n    pointer-events: all;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: ${UNLINK_BUTTON_SIZE}px;\n    height: ${UNLINK_BUTTON_SIZE}px;\n    border-radius: ${UNLINK_BUTTON_SIZE / 2}px;\n    cursor: pointer;\n    background-color: ${props => props.theme.colors.background};\n    color: ${props => props.theme.colors.accentColor};\n    border: 2px solid ${props => props.theme.colors.accentColor};\n    font-size: 10px;\n`\n\nconst Circle = styled.circle`\n    fill: ${props => props.theme.colors.background};\n    stroke: ${props => props.theme.colors.accentColor};\n    stroke-width: 2px;\n`\n","import { ResolvedLink } from '../state'\nimport { LinkWidget } from './LinkWidget'\n\nexport const LinksLayer = ({ links }: { links: ResolvedLink[] }) => {\n    return (\n        <svg\n            style={{\n                position: 'absolute',\n                width: '100%',\n                height: '100%',\n                pointerEvents: 'none',\n            }}\n        >\n            {links.map(link => (\n                <LinkWidget key={link.id} link={link} />\n            ))}\n        </svg>\n    )\n}\n","import {\n    ChangeEvent,\n    KeyboardEvent as ReactKeyboardEvent,\n    useCallback,\n    useEffect,\n    useRef,\n    useState,\n    memo,\n} from 'react'\nimport styled from 'styled-components'\nimport { MdEdit } from 'react-icons/md'\nimport { ElementId, useUpdateNode } from '../../state'\nimport { useDocumentEventListener } from '../../utils/useDocumentEventListener'\n\nexport const NodeName = memo(({ id, name: currentName }: { id: ElementId; name: string }) => {\n    const [isEditing, setIsEditing] = useState(false)\n    const [name, setName] = useState(currentName)\n    const updateNode = useUpdateNode()\n    const inputRef = useRef<HTMLInputElement | null>(null)\n\n    useEffect(() => {\n        if (isEditing && inputRef.current) {\n            inputRef.current?.focus()\n        }\n    }, [isEditing, inputRef])\n\n    useEffect(() => {\n        setName(currentName)\n        setIsEditing(false)\n    }, [currentName, setName, setIsEditing])\n\n    const handleChange = useCallback(\n        (event: ChangeEvent<HTMLInputElement>) => {\n            setName(event.target.value)\n        },\n        [setName]\n    )\n\n    const handleEnter = (event: ReactKeyboardEvent<HTMLInputElement>) => {\n        if (event.key === 'Enter') {\n            updateNode(id, { name })\n            setIsEditing(false)\n        }\n    }\n\n    const handleEscape = useCallback(\n        (event: KeyboardEvent) => {\n            if (event.key === 'Escape') {\n                setIsEditing(false)\n            }\n        },\n        [setIsEditing]\n    )\n    useDocumentEventListener('keydown', handleEscape)\n\n    return (\n        <Container\n            onClick={() => {\n                if (!isEditing) {\n                    setIsEditing(true)\n                }\n            }}\n        >\n            {!isEditing && (\n                <>\n                    <Name>{currentName}</Name>\n                    <Icon>\n                        <MdEdit />\n                    </Icon>\n                </>\n            )}\n            {isEditing && (\n                <Input\n                    ref={inputRef}\n                    onKeyPress={handleEnter}\n                    type=\"text\"\n                    value={name}\n                    onChange={handleChange}\n                />\n            )}\n        </Container>\n    )\n})\n\nconst Icon = styled.span`\n    margin-left: 12px;\n    width: 24px;\n    height: 24px;\n    border-radius: 3px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: #333333;\n    color: #999999;\n    cursor: pointer;\n    flex-shrink: 0;\n`\n\nconst Input = styled.input`\n    width: calc(100% - 32px);\n    height: 32px;\n    border: none;\n    padding: 5px 9px;\n    border-radius: 2px;\n    font-weight: 800;\n    font-family: inherit;\n    background-color: #aaaaaa;\n    font-size: 14px;\n\n    &:focus {\n        outline: 0;\n    }\n`\n\nconst Name = styled.span`\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n`\n\nconst Container = styled.div`\n    height: 32px;\n    padding: 0;\n    margin: 0 32px 9px 0;\n    font-size: 16px;\n    font-weight: 800;\n    display: flex;\n    align-items: center;\n`\n","import { useEffect } from 'react'\n\n/**\n * This hook can be used to attach event listener to the document,\n * it will take care of removing/updating the listener if it changes,\n * and will also remove the listener when the component it's attached\n * to is unmounted.\n */\nexport const useDocumentEventListener = <K extends keyof DocumentEventMap>(\n    eventType: K,\n    listener: (this: Document, event: DocumentEventMap[K]) => any\n) => {\n    useEffect(() => {\n        document.addEventListener(eventType, listener)\n\n        return () => {\n            document.removeEventListener(eventType, listener)\n        }\n    }, [listener])\n}\n","import { createElement, useCallback, memo } from 'react'\nimport styled from 'styled-components'\nimport { FaTimes } from 'react-icons/fa'\nimport { ElementId, ResolvedProperty, useSetSelectedNodeIds, useUnlink } from '../../state'\nimport registry from '../../registry'\n\nconst Relation = memo(\n    ({\n        ownId,\n        elementId,\n        nodeId,\n        name,\n        parentName,\n    }: {\n        ownId: ElementId\n        elementId: ElementId\n        nodeId: ElementId\n        name: string\n        parentName?: string\n    }) => {\n        const setSelectedNodeIds = useSetSelectedNodeIds()\n        const unlink = useUnlink()\n\n        const goToRelation = useCallback(() => {\n            setSelectedNodeIds([nodeId])\n        }, [setSelectedNodeIds, nodeId])\n\n        const handleUnlink = useCallback(() => {\n            unlink(elementId, ownId)\n        }, [unlink, ownId, elementId])\n\n        return (\n            <RelationContainer>\n                <RelationName onClick={goToRelation}>\n                    {parentName && <span>{parentName}.</span>}\n                    {name}\n                </RelationName>\n                <UnlinkIcon onClick={handleUnlink}>\n                    <FaTimes />\n                </UnlinkIcon>\n            </RelationContainer>\n        )\n    }\n)\n\nexport const PropertyItem = memo(({ property }: { property: ResolvedProperty }) => {\n    const propertyService = registry.getPropertyService(property.type)\n\n    const hasInput = property.input !== undefined\n\n    return (\n        <Container>\n            <PropertyHeader>\n                <PropertyName>{property.name}</PropertyName>\n                {hasInput && (\n                    <Relation\n                        ownId={property.id}\n                        elementId={property.input!.id}\n                        nodeId={\n                            property.input!.elementType === 'node'\n                                ? property.input!.id\n                                : (property.input! as any).node.id\n                        }\n                        name={property.input!.name}\n                        parentName={\n                            property.input!.elementType === 'property'\n                                ? (property.input! as any).node.name\n                                : undefined\n                        }\n                    />\n                )}\n            </PropertyHeader>\n            {!hasInput && propertyService.control && (\n                <ControlContainer>\n                    {createElement(propertyService.control, { property })}\n                </ControlContainer>\n            )}\n        </Container>\n    )\n})\n\nconst Container = styled.div`\n    padding: 9px 12px;\n    border-bottom: 1px solid ${props => props.theme.colors.lightBorder};\n\n    &:last-child {\n        border-bottom: none;\n    }\n`\n\nconst PropertyHeader = styled.div`\n    display: grid;\n    grid-template-columns: 40% 60%;\n    align-items: center;\n`\n\nconst PropertyName = styled.h4`\n    margin: 0;\n    padding: 0;\n`\n\nconst RelationContainer = styled.div`\n    display: flex;\n    align-items: center;\n    height: 24px;\n    border-radius: 2px;\n    color: ${props => props.theme.colors.accentColor};\n`\n\nconst RelationName = styled.span`\n    padding: 0 6px;\n    height: 100%;\n    flex-grow: 1;\n    line-height: 24px;\n    cursor: pointer;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    background-color: ${props => props.theme.colors.badgeBackground};\n    font-weight: 600;\n    font-size: 11px;\n\n    &:hover {\n        background-color: #444444;\n    }\n`\n\nconst UnlinkIcon = styled.span`\n    width: 24px;\n    height: 24px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-shrink: 0;\n    background-color: #444444;\n    border-radius: 0 2px 2px 0;\n    font-size: 10px;\n    cursor: pointer;\n\n    &:hover {\n        background-color: #555555;\n    }\n`\n\nconst ControlContainer = styled.div`\n    margin-top: 6px;\n`\n","import { memo } from 'react'\nimport styled from 'styled-components'\nimport { MdClose } from 'react-icons/md'\nimport registry from '../../registry'\nimport { ResolvedNode, useStore } from '../../state'\nimport { NodeName } from './NodeName'\nimport { PropertyItem } from './PropertyItem'\nimport { useCallback } from 'react'\n\nexport const NodeInfoPanel = memo(({ node }: { node: ResolvedNode }) => {\n    const nodeService = registry.getNodeService(node.type)\n    const { setSelectedNodeIds } = useStore()\n    const value: any = nodeService.getValue(node, registry)\n\n    const handleClose = useCallback(() => {\n        setSelectedNodeIds([])\n    }, [setSelectedNodeIds])\n\n    return (\n        <div>\n            <Header>\n                <NodeName id={node.id} name={node.name} />\n                <Id>{node.type}</Id>\n                <Close onClick={handleClose}>\n                    <MdClose />\n                </Close>\n            </Header>\n            <Properties>\n                {node.properties.map(property => (\n                    <PropertyItem key={property.id} property={property} />\n                ))}\n            </Properties>\n            {value !== undefined && (\n                <>\n                    <NodeValueTitle>Node value</NodeValueTitle>\n                    {!value.$$typeof && <NodeValue>{JSON.stringify(value, null, '  ')}</NodeValue>}\n                    {value.$$typeof && (\n                        <NodeValue>{JSON.stringify(value.props, null, '  ')}</NodeValue>\n                    )}\n                </>\n            )}\n        </div>\n    )\n})\n\nconst Header = styled.header`\n    padding: 9px 12px;\n    border-bottom: 1px solid ${props => props.theme.colors.border};\n    position: relative;\n`\n\nconst Id = styled.div`\n    font-size: 12px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n`\n\nconst Close = styled.span`\n    position: absolute;\n    width: 32px;\n    height: 32px;\n    top: 9px;\n    right: 12px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    cursor: pointer;\n    font-size: 18px;\n    color: #999999;\n\n    &:hover {\n        color: #eeeeee;\n    }\n`\n\nconst Properties = styled.div``\n\nconst NodeValueTitle = styled.h4`\n    border-top: 1px solid ${props => props.theme.colors.border};\n    padding: 6px 12px;\n    margin: 0;\n`\n\nconst NodeValue = styled.pre`\n    padding: 12px;\n    font-size: 12px;\n    margin: 0;\n    background-color: ${props => props.theme.colors.topDepthBackground};\n`\n","import { createElement, useCallback, MouseEvent, memo } from 'react'\nimport styled from 'styled-components'\nimport { transparentize } from 'polished'\nimport { ResolvedNode, useStore } from '../state'\nimport registry from '../registry'\nimport { PropertiesWidget } from './PropertiesWidget'\nimport { PortWidget } from './PortWidget'\n\nexport const NodeWidget = memo(({ node }: { node: ResolvedNode }) => {\n    const nodeService = registry.getNodeService(node.type)\n    const hasCustomWidget = 'widget' in nodeService\n    const { setSelectedNodeIds, startDrag } = useStore()\n\n    const handleStartDrag = useCallback(\n        (event: MouseEvent) => {\n            setSelectedNodeIds([node.id])\n            startDrag(node.id, [event.clientX, event.clientY])\n        },\n        [setSelectedNodeIds, node.id, startDrag]\n    )\n\n    return (\n        <NodeContainer\n            onMouseDown={handleStartDrag}\n            isSelected={node.isSelected}\n            style={{\n                top: node.y,\n                left: node.x,\n                width: node.width,\n            }}\n        >\n            <NodeHeader>\n                <span>{node.name}</span>\n                {nodeService.hasOutput && (\n                    <PortWidget\n                        type=\"source\"\n                        elementId={node.id}\n                        x={node.x + node.width}\n                        y={node.y + 12}\n                    />\n                )}\n            </NodeHeader>\n            {!hasCustomWidget && <PropertiesWidget properties={node.properties} />}\n            {hasCustomWidget && createElement(nodeService.widget!, { node, registry })}\n        </NodeContainer>\n    )\n})\n\nconst NodeContainer = styled.div<{\n    isSelected: boolean\n}>`\n    pointer-events: all;\n    user-select: none;\n    background-color: transparent;\n    color: ${props => props.theme.colors.accentColor};\n    position: absolute;\n    box-shadow: ${props =>\n        props.isSelected\n            ? `0 0 0 2px ${props.theme.colors.accentColor}`\n            : `0 0 0 1px ${props.theme.colors.nodeBorder}`};\n    cursor: move;\n    font-size: 12px;\n\n    &:hover {\n        box-shadow: ${props =>\n            props.isSelected\n                ? `0 0 0 2px ${props.theme.colors.accentColor}`\n                : `0 0 0 1px ${props.theme.colors.accentColor}`};\n    }\n`\n\nconst NodeHeader = styled.header`\n    position: relative;\n    font-weight: 600;\n    background-color: ${props => transparentize(0.15, props.theme.colors.topDepthBackground)};\n    display: flex;\n    align-items: center;\n    height: 24px;\n    padding: 0 12px;\n\n    span {\n        white-space: nowrap;\n        text-overflow: ellipsis;\n    }\n`\n","import styled from 'styled-components'\nimport { ResolvedNode } from '../state'\nimport { NodeWidget } from './NodeWidget'\n\nexport const NodesLayer = ({ nodes }: { nodes: ResolvedNode[] }) => {\n    return (\n        <Layer>\n            {nodes.map(node => (\n                <NodeWidget key={node.id} node={node} />\n            ))}\n        </Layer>\n    )\n}\n\nconst Layer = styled.div`\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n`\n","import { ReactNode, KeyboardEvent } from 'react'\nimport { createPortal } from 'react-dom'\nimport styled from 'styled-components'\n\nexport const Modal = ({\n    children,\n    maxWidth,\n    onCloseRequest,\n}: {\n    children: ReactNode\n    maxWidth?: number\n    onCloseRequest(): void\n}) => {\n    const handleKeydown = (event: KeyboardEvent) => {}\n\n    return createPortal(\n        <Container role=\"dialog\" aria-modal=\"true\" onKeyDown={handleKeydown}>\n            <Background onClick={onCloseRequest} />\n            <Content maxWidth={maxWidth}>{children}</Content>\n        </Container>,\n        document.body\n    )\n}\n\nconst Container = styled.div`\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    overflow: auto;\n    padding: 12px;\n`\n\nconst Background = styled.div`\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 1;\n    background-color: ${props => props.theme.colors.overlay};\n`\n\nconst Content = styled.div<{\n    maxWidth?: number\n}>`\n    position: relative;\n    z-index: 2;\n    width: 100%;\n    background: ${props => props.theme.colors.topDepthBackground};\n    backdrop-filter: none;\n    max-width: ${props => (props.maxWidth ? `${props.maxWidth}px` : 'none')};\n    max-height: 100%;\n    overflow-y: scroll;\n    box-shadow: 0 0 0 5px ${props => props.theme.colors.border};\n`\n\nexport const ModalTitle = styled.h2`\n    margin: 0;\n    padding: 9px 12px;\n    border-bottom: 1px solid ${props => props.theme.colors.border};\n    font-size: 16px;\n    display: flex;\n    align-items: center;\n\n    svg {\n        color: ${props => props.theme.colors.accentColor};\n        margin-right: 12px;\n    }\n`\n","import { PropsWithChildren } from 'react'\nimport styled from 'styled-components'\n\nconst Button = styled.div`\n    width: 64px;\n    height: 64px;\n    cursor: pointer;\n    background-color: ${props => props.theme.colors.topDepthBackground};\n    color: #777777;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-size: 22px;\n\n    &:hover {\n        background-color: #222222;\n        color: #eeeeee;\n    }\n`\n\nexport const SidebarButton = ({\n    children,\n    onClick,\n}: PropsWithChildren<{\n    onClick: () => void\n}>) => {\n    return <Button onClick={onClick}>{children}</Button>\n}\n","import { useMemo } from 'react'\nimport styled from 'styled-components'\nimport registry from '../registry'\nimport { useCreateNode } from '../state'\nimport { NodeService } from '../services_registry'\n\nconst NodeType = ({ type, onCreate }: { type: NodeService<string, any>; onCreate: () => void }) => {\n    const createNode = useCreateNode()\n\n    return (\n        <NodeTypeItem\n            onClick={() => {\n                createNode(type.type)\n                onCreate()\n            }}\n        >\n            <div>{type.type}</div>\n            {type.description && <NodeTypeDescription>{type.description}</NodeTypeDescription>}\n        </NodeTypeItem>\n    )\n}\n\nconst Category = ({\n    category,\n    onCreate,\n}: {\n    category: {\n        category: string\n        types: NodeService<string, any>[]\n    }\n    onCreate: () => void\n}) => {\n    return (\n        <div>\n            <CategoryTitle>{category.category}</CategoryTitle>\n            {category.types.map(type => (\n                <NodeType key={type.type} type={type} onCreate={onCreate} />\n            ))}\n        </div>\n    )\n}\n\nexport const NodeSelector = ({ onCreate }: { onCreate: () => void }) => {\n    const categories = useMemo(() => registry.getNodeServiceCategories(), [])\n\n    return (\n        <Container>\n            {categories.map(category => (\n                <Category key={category.category} category={category} onCreate={onCreate} />\n            ))}\n        </Container>\n    )\n}\n\nconst Container = styled.div`\n    max-height: 600px;\n    overflow-y: auto;\n`\n\nconst CategoryTitle = styled.h3`\n    padding: 9px 12px;\n    margin: 0;\n    background-color: ${props => props.theme.colors.mediumDepthBackground};\n    font-size: 16px;\n    color: ${props => props.theme.colors.accentColor};\n`\n\nconst NodeTypeItem = styled.div`\n    padding: 12px 12px;\n    border-bottom: 1px solid ${props => props.theme.colors.lightBorder};\n    font-size: 14px;\n    cursor: pointer;\n    font-weight: 600;\n\n    &:last-child {\n        border-bottom: none;\n    }\n\n    &:hover {\n        background-color: ${props => props.theme.colors.mediumDepthBackground};\n    }\n`\n\nconst NodeTypeDescription = styled.div`\n    font-weight: 400;\n    font-size: 12px;\n    margin-top: 6px;\n    color: #aaaaaa;\n`\n","import { useState, memo } from 'react'\nimport { MdLibraryAdd } from 'react-icons/md'\nimport { Modal, ModalTitle } from './Modal'\nimport { SidebarButton } from './SidebarButton'\nimport { NodeSelector } from './NodeSelector'\n\nexport const AddNodeButton = memo(() => {\n    const [isOpen, setIsOpen] = useState(false)\n\n    return (\n        <>\n            <SidebarButton\n                onClick={() => {\n                    setIsOpen(true)\n                }}\n            >\n                <MdLibraryAdd />\n            </SidebarButton>\n            {isOpen && (\n                <Modal\n                    onCloseRequest={() => {\n                        setIsOpen(false)\n                    }}\n                    maxWidth={600}\n                >\n                    <ModalTitle>\n                        <MdLibraryAdd /> Add new node\n                    </ModalTitle>\n                    <NodeSelector\n                        onCreate={() => {\n                            setIsOpen(false)\n                        }}\n                    />\n                </Modal>\n            )}\n        </>\n    )\n})\n","import { useCallback, useState, memo } from 'react'\nimport styled from 'styled-components'\nimport { MdNoteAdd } from 'react-icons/md'\nimport { useLoadGraph } from '../state'\nimport { Modal, ModalTitle } from './Modal'\nimport { SidebarButton } from './SidebarButton'\n\nexport const NewGraph = memo(() => {\n    const [isOpen, setIsOpen] = useState(false)\n    const loadGraph = useLoadGraph()\n\n    const handleNewGraph = useCallback(() => {\n        loadGraph({ nodes: [], links: [] })\n        setIsOpen(false)\n    }, [loadGraph, setIsOpen])\n\n    return (\n        <>\n            <SidebarButton\n                onClick={() => {\n                    setIsOpen(true)\n                }}\n            >\n                <MdNoteAdd />\n            </SidebarButton>\n            {isOpen && (\n                <Modal\n                    onCloseRequest={() => {\n                        setIsOpen(false)\n                    }}\n                    maxWidth={300}\n                >\n                    <ModalTitle>\n                        <MdNoteAdd /> Create new graph?\n                    </ModalTitle>\n                    <ConfirmContainer>\n                        <Button onClick={handleNewGraph}>yes</Button>\n                        <Button\n                            onClick={() => {\n                                setIsOpen(false)\n                            }}\n                        >\n                            no\n                        </Button>\n                    </ConfirmContainer>\n                </Modal>\n            )}\n        </>\n    )\n})\n\nconst ConfirmContainer = styled.div`\n    padding: 16px;\n    display: flex;\n    justify-content: center;\n`\n\nconst Button = styled.span`\n    padding: 9px 12px;\n    background-color: #000000;\n    border-radius: 2px;\n    margin-left: 12px;\n    cursor: pointer;\n    width: 80px;\n    text-align: center;\n\n    &:first-child {\n        margin-left: 0;\n    }\n`\n","import { fileOpen, fileSave } from 'browser-nativefs'\nimport { ResolvedLink, ResolvedNode, serializeElements } from './state'\n\nexport const saveAsJSON = async (nodes: ResolvedNode[], links: ResolvedLink[]) => {\n    const serialized = serializeElements(nodes, links)\n    const stringified = JSON.stringify(\n        {\n            type: 'nivo-graph',\n            version: 'beta',\n            ...serialized,\n        },\n        null,\n        2\n    )\n\n    const blob = new Blob([stringified], {\n        type: 'application/json',\n    })\n\n    const fileHandle = await fileSave(\n        blob,\n        {\n            fileName: 'graph',\n            description: 'Nivo graph',\n            extensions: ['.json'],\n        },\n        null //appState.fileHandle\n    )\n\n    return { fileHandle }\n}\n\nexport const parseFileContent = async (blob: Blob | File) => {\n    let content: string\n    if ('text' in Blob) {\n        content = await blob.text()\n    } else {\n        content = await new Promise(resolve => {\n            const reader = new FileReader()\n            reader.readAsText(blob, 'utf8')\n            reader.onloadend = () => {\n                if (reader.readyState === FileReader.DONE) {\n                    resolve(reader.result as string)\n                }\n            }\n        })\n    }\n\n    return JSON.parse(content)\n}\n\nexport const loadFromJSON = async () => {\n    const blob = await fileOpen({\n        description: 'Nivo graph files',\n        extensions: ['.json', '.nivo'],\n        mimeTypes: ['application/json'],\n    })\n\n    const content = await parseFileContent(blob)\n    if (content.type !== 'nivo-graph') {\n        throw new Error('graph file is invalid')\n    }\n\n    return content\n}\n","import { MdSave } from 'react-icons/md'\nimport { ResolvedLink, ResolvedNode } from '../state'\nimport { saveAsJSON } from '../fs'\nimport { SidebarButton } from './SidebarButton'\n\ninterface SaveProps {\n    nodes: ResolvedNode[]\n    links: ResolvedLink[]\n}\n\nexport const SaveGraph = ({ nodes, links }: SaveProps) => {\n    const handleSave = () => {\n        saveAsJSON(nodes, links)\n    }\n\n    return (\n        <SidebarButton onClick={handleSave}>\n            <MdSave />\n        </SidebarButton>\n    )\n}\n","import { MdFolderOpen } from 'react-icons/md'\nimport { loadFromJSON } from '../fs'\nimport { useStore } from '../state'\nimport { SidebarButton } from './SidebarButton'\nimport { useCallback } from 'react'\n\nexport const OpenGraph = () => {\n    const { loadGraph } = useStore()\n\n    const handleOpen = useCallback(() => {\n        loadFromJSON().then(graph => {\n            loadGraph(graph)\n        })\n    }, [loadGraph])\n\n    return (\n        <SidebarButton onClick={handleOpen}>\n            <MdFolderOpen />\n        </SidebarButton>\n    )\n}\n","import { useState } from 'react'\nimport styled from 'styled-components'\nimport { MdSettings } from 'react-icons/md'\nimport { themes } from '../theming'\nimport { SidebarButton } from './SidebarButton'\nimport { Modal, ModalTitle } from './Modal'\nimport { useStore } from '../state'\n\nexport const Settings = () => {\n    const [isOpen, setIsOpen] = useState(false)\n\n    const { settings, setSettings } = useStore()\n\n    return (\n        <>\n            <SidebarButton\n                onClick={() => {\n                    setIsOpen(true)\n                }}\n            >\n                <MdSettings />\n            </SidebarButton>\n            {isOpen && (\n                <Modal\n                    onCloseRequest={() => {\n                        setIsOpen(false)\n                    }}\n                    maxWidth={500}\n                >\n                    <ModalTitle>\n                        <MdSettings /> Settings\n                    </ModalTitle>\n                    <Container>\n                        <span>Theme</span>\n                        <select\n                            value={settings.themeId}\n                            onChange={event => {\n                                setSettings({\n                                    themeId: event.target.value,\n                                })\n                            }}\n                        >\n                            {themes.map(theme => {\n                                return (\n                                    <option key={theme.id} value={theme.id}>\n                                        {theme.name}\n                                    </option>\n                                )\n                            })}\n                        </select>\n                    </Container>\n                </Modal>\n            )}\n        </>\n    )\n}\n\nconst Container = styled.div`\n    padding: 12px;\n    display: grid;\n    grid-template-columns: 90px 1fr;\n`\n","import styled from 'styled-components'\nimport { ResolvedLink, ResolvedNode } from '../state'\nimport { AddNodeButton } from './AddNodeButton'\nimport { NewGraph } from './NewGraph'\nimport { SaveGraph } from './SaveGraph'\nimport { OpenGraph } from './OpenGraph'\nimport { Settings } from './Settings'\n\nexport const Sidebar = ({ nodes, links }: { nodes: ResolvedNode[]; links: ResolvedLink[] }) => {\n    return (\n        <Container>\n            <AddNodeButton />\n            <SaveGraph nodes={nodes} links={links} />\n            <OpenGraph />\n            <NewGraph />\n            <Settings />\n        </Container>\n    )\n}\n\nconst Container = styled.div`\n    position: fixed;\n    top: 46px;\n    left: 0;\n    width: 64px;\n    height: 100%;\n    background: ${props => props.theme.colors.topDepthBackground};\n`\n","import chordExample from './chord.json'\nimport seriesExample from './series.json'\n\nexport const examples = [\n    {\n        name: 'Chord diagram',\n        data: chordExample,\n    },\n    {\n        name: 'XY series charts',\n        data: seriesExample,\n    },\n]\n","import styled from 'styled-components'\nimport { FaExternalLinkAlt } from 'react-icons/fa'\nimport { examples } from '../examples'\nimport { useStore } from '../state'\nimport { useCallback } from 'react'\n\nconst ExampleItem = ({\n    example,\n    onLoad,\n}: {\n    example: {\n        name: string\n        data: any\n    }\n    onLoad: () => void\n}) => {\n    const { loadGraph } = useStore()\n\n    const handleLoad = useCallback(() => {\n        loadGraph(example.data)\n        onLoad()\n    }, [loadGraph, example.data, onLoad])\n\n    return (\n        <ExampleItemContainer onClick={handleLoad}>\n            {example.name}\n            <FaExternalLinkAlt />\n        </ExampleItemContainer>\n    )\n}\n\nconst ExampleItemContainer = styled.div`\n    display: flex;\n    padding: 6px 9px 6px 12px;\n    align-items: center;\n    background-color: #000000;\n    border-radius: 2px;\n    color: ${props => props.theme.colors.accentColor};\n    cursor: pointer;\n    margin: 0 12px 9px 0;\n\n    svg {\n        margin-left: 12px;\n    }\n\n    &:hover {\n        box-shadow: 0 0 0 2px pink;\n    }\n`\n\nexport const ExampleLoader = ({ onLoad }: { onLoad: () => void }) => {\n    return (\n        <Container>\n            {examples.map(example => (\n                <ExampleItem key={example.name} example={example} onLoad={onLoad} />\n            ))}\n        </Container>\n    )\n}\n\nconst Container = styled.div`\n    display: flex;\n    justify-content: center;\n    flex-wrap: wrap;\n    margin: 12px 0 3px;\n`\n","import { useCallback, useState } from 'react'\nimport styled from 'styled-components'\nimport { Modal, ModalTitle } from './Modal'\nimport { ExampleLoader } from './ExampleLoader'\n\nexport const Welcome = () => {\n    const [isOpen, setIsOpen] = useState(true)\n\n    const handleClose = useCallback(() => {\n        setIsOpen(false)\n    }, [setIsOpen])\n\n    return (\n        <>\n            {isOpen && (\n                <Modal onCloseRequest={handleClose} maxWidth={500}>\n                    <ModalTitle>Welcome</ModalTitle>\n                    <Message>\n                        <p>\n                            Welcome to the new nivo graph editor! This application is currently an\n                            early prototype, so things might (and will) break ¯\\_(ツ)_/¯, sorry for\n                            that.\n                        </p>\n                        <p>\n                            The motivation behind this project is to provide a way to visually\n                            create charts, without code, allowing people without too much technical\n                            background to easily use nivo charts.\n                        </p>\n                        <p>In order to get started, you can have a look at one of the example:</p>\n                        <ExampleLoader onLoad={handleClose} />\n                        <p>Otherwise, you can just start form scratch and craft your own chart.</p>\n                        <div\n                            style={{\n                                display: 'flex',\n                                justifyContent: 'center',\n                                margin: '12px 0',\n                            }}\n                        >\n                            <span\n                                onClick={handleClose}\n                                style={{\n                                    padding: '9px 12px',\n                                    backgroundColor: '#000',\n                                    borderRadius: '2px',\n                                    cursor: 'pointer',\n                                }}\n                            >\n                                Start from scratch\n                            </span>\n                        </div>\n                        <p>\n                            We hope you'll enjoy using this tool as much as we enjoy building it!\n                            &lt;3\n                        </p>\n                    </Message>\n                </Modal>\n            )}\n        </>\n    )\n}\n\nconst Message = styled.div`\n    padding: 12px 12px 0;\n    font-size: 12px;\n\n    p {\n        margin: 0 0 12px;\n    }\n`\n","import { MouseEvent, useCallback } from 'react'\nimport styled, { ThemeProvider } from 'styled-components'\nimport { useStore, useSelectedNodes, useGraph } from './state'\nimport { useCurrentTheme, GlobalStyle } from './theming'\nimport {\n    AppHeader,\n    AppFooter,\n    NodesLayer,\n    LinkingLayer,\n    LinksLayer,\n    NodeInfoPanel,\n    Sidebar,\n    Welcome,\n} from './components'\n\nexport const App = () => {\n    const store = useStore()\n    const theme = useCurrentTheme()\n    const { nodes, links } = useGraph()\n    const selectedNodes = useSelectedNodes()\n\n    const { drag, updateDrag, stopDrag, linking, updateLinking, stopLinking } = store\n    const handleMouseMove = useCallback(\n        (event: MouseEvent) => {\n            if (drag.isDragging) {\n                updateDrag([event.clientX, event.clientY])\n            }\n            if (linking.isLinking) {\n                updateLinking([event.clientX, event.clientY])\n            }\n        },\n        [drag.isDragging, updateDrag, linking.isLinking, updateLinking]\n    )\n    const handleMouseOut = useCallback(\n        (event: MouseEvent) => {\n            if (drag.isDragging) {\n                stopDrag()\n            }\n            if (linking.isLinking) {\n                stopLinking()\n            }\n        },\n        [drag.isDragging, stopDrag, linking.isLinking, stopLinking]\n    )\n\n    return (\n        <ThemeProvider theme={theme}>\n            <GlobalStyle />\n            <AppHeader />\n            <Sidebar nodes={nodes} links={links} />\n            <Canvas\n                onMouseMove={handleMouseMove}\n                onMouseUp={handleMouseOut}\n                onMouseLeave={handleMouseOut}\n            >\n                <LinksLayer links={links} />\n                <NodesLayer nodes={nodes} />\n                <LinkingLayer />\n            </Canvas>\n            <InfoPanel>\n                {selectedNodes.length === 1 && <NodeInfoPanel node={selectedNodes[0]} />}\n            </InfoPanel>\n            <AppFooter />\n            <Welcome />\n        </ThemeProvider>\n    )\n}\n\nconst Canvas = styled.div`\n    position: fixed;\n    top: 46px;\n    bottom: 52px;\n    left: 64px;\n    width: calc(100% - 364px);\n    height: calc(100% - 82px);\n    background: ${props => props.theme.colors.background};\n    overflow: hidden;\n`\n\nconst InfoPanel = styled.div`\n    position: fixed;\n    top: 46px;\n    right: 0;\n    width: 300px;\n    height: 100%;\n    background: ${props => props.theme.colors.topDepthBackground};\n    overflow-y: auto;\n`\n","import { useMemo } from 'react'\nimport { useSettings } from '../state'\nimport { themes } from './themes'\n\nexport const useCurrentTheme = () => {\n    const { themeId } = useSettings()\n\n    return useMemo(() => {\n        const theme = themes.find(theme => theme.id === themeId)\n        if (!theme) {\n            throw new Error(`no theme found matching id: ${themeId}`)\n        }\n\n        return theme.theme\n    }, [themeId])\n}\n","const reportWebVitals = onPerfEntry => {\n    if (onPerfEntry && onPerfEntry instanceof Function) {\n        import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n            getCLS(onPerfEntry)\n            getFID(onPerfEntry)\n            getFCP(onPerfEntry)\n            getLCP(onPerfEntry)\n            getTTFB(onPerfEntry)\n        })\n    }\n}\n\nexport default reportWebVitals\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { App } from './App'\nimport reportWebVitals from './reportWebVitals'\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n","export * from './AnglePropertyService'\nexport * from './ArrayStringPropertyService'\nexport * from './ArrayXYPropertyService'\nexport * from './BlendModePropertyService'\nexport * from './ChoicesPropertyService'\nexport * from './CustomPropertyService'\nexport * from './MatrixPropertyService'\nexport * from './NumberPropertyService'\nexport * from './RefPropertyService'\nexport * from './TextPropertyService'\n","import { PropertyService } from '../services_registry'\nimport { useStore, Property } from '../state'\nimport { ChangeEvent } from 'react'\n\nexport type ChoiceProperty = {\n    choices: {\n        label: string\n        value: string | number\n    }[]\n    value: string | number\n}\n\nexport type ChoicesPropertyOptions = {\n    name: string\n    defaultValue?: ChoiceProperty['value']\n    choices: ChoiceProperty['choices']\n    hasInput?: boolean\n    hasOutput?: boolean\n}\n\nexport const ChoicesPropertyControl = ({ property }: { property: Property & ChoiceProperty }) => {\n    const { updateProperty } = useStore()\n\n    const handleChange = (event: ChangeEvent<HTMLSelectElement>) => {\n        updateProperty(property.id, {\n            value: event.target.value,\n        })\n    }\n\n    return (\n        <select value={property.value} onChange={handleChange}>\n            {property.choices.map(choice => {\n                return (\n                    <option key={choice.value} value={choice.value}>\n                        {choice.label}\n                    </option>\n                )\n            })}\n        </select>\n    )\n}\n\nexport const ChoicesPropertyService: PropertyService<\n    'choices',\n    ChoicesPropertyOptions,\n    ChoiceProperty,\n    string | number\n> = {\n    type: 'choices',\n    factory: ({\n        name,\n        choices,\n        defaultValue,\n        hasInput = false,\n        hasOutput = false,\n    }: ChoicesPropertyOptions) => {\n        return {\n            name,\n            type: 'choices',\n            choices,\n            value: defaultValue,\n            hasInput,\n            hasOutput,\n        }\n    },\n    serialize: property => {\n        // @ts-ignore\n        return property.value\n    },\n    hydrate: (property, data) => {\n        return {\n            ...property,\n            value: data,\n        }\n    },\n    getValue: data => {\n        return data.value\n    },\n    control: ChoicesPropertyControl,\n}\n"],"sourceRoot":""}